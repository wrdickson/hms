import{y as i,i as _,z as R,j as b,_ as F,c as h,d as l,e as p,b as o,w as m,t as u,F as T,h as D,m as S,r as d,o as f}from"./index.33301253.js";import{E as k,a as M}from"./jspdf.plugin.autotable.11da63bd.js";const v={name:"ShiftReport",data(){return{endTime:i().format("YYYY MM DD")+" 23:59:59",reportGeneratedTime:null,startTime:i().format("YYYY MM DD"),shiftReport:null}},computed:{account(){return _().account},endTimeF(){return i(this.endTime).format("YYYY-MM-DD HH:mm:ss")},startTimeF(){return i(this.startTime).format("YYYY-MM-DD HH:mm:ss")},siteName(){return R().autoloadOptions.site_name.option_value},token(){return _().token}},methods:{clearReport(){this.shiftReport=null,this.reportGeneratedTime=null,this.startTime=i().format("YYYY MM DD"),this.endTime=i().format("YYYY MM DD")+" 23:59:59"},generatePdf(){const t=new k;t.setFontSize(12);let e=20;t.text(this.siteName+" Shift Report - Detail",20,e),e+=5,t.setFontSize(10),t.text("Account: "+this.account.username,20,e),e+=5,t.text("Filter Start: "+this.startTimeF,20,e),e+=5,t.text("Filter End: "+this.endTimeF,20,e),e+=5,t.text("Generated: "+this.reportGeneratedTime,20,e),e+=5,t.line(20,e,180,e),e+=5,this.shiftReport.report_by_payment_type.forEach(n=>{t.setFontSize(11),t.text(n.payment_type_title,20,e),t.setFontSize(10),e+=4,t.text("Total: "+n.total,20,e),e+=2;let s=[];n.payments.forEach(a=>{let c=[a.datetime_posted,a.payment_title,a.total,a.folio,a.last_name,a.first_name];s.push(c)}),M(t,{head:[["Posted","Type","Amount","Folio","Last Name","First Name"]],body:s,theme:"striped",cellWidth:50,tableWidth:120,margin:{left:21,top:0,bottom:0},styles:{cellPadding:1,fontSize:8},headStyles:{fillColor:[80,80,80],fontSize:8},startY:e,startX:30}),e=t.lastAutoTable.finalY+1,t.line(20,e,180,e),e+=5}),t.text("**** Report End ****",70,e),t.save("Shift Report "+this.reportGeneratedTime)},runReport(){this.shiftReport=null,this.reportGeneratedTime=i().format("YYYY-MM-DD HH-mm-ss"),b.reports.runShiftReport(this.startTimeF,this.endTimeF,this.token).then(t=>{this.shiftReport=t.data.shift_report})}}},C=l("hr",null,null,-1),w={key:0},N=l("hr",null,null,-1);function V(t,e){const n=d("el-date-picker"),s=d("el-button"),a=d("el-table-column"),c=d("el-table"),Y=d("el-collapse-item"),y=d("el-collapse");return f(),h(T,null,[l("div",null,[p(" Start: "),o(n,{modelValue:t.startTime,"onUpdate:modelValue":e[0]||(e[0]=r=>t.startTime=r),type:"datetime"},null,8,["modelValue"]),p(" End: "),o(n,{modelValue:t.endTime,"onUpdate:modelValue":e[1]||(e[1]=r=>t.endTime=r),type:"datetime"},null,8,["modelValue"])]),o(s,{onClick:t.clearReport,type:"primary"},{default:m(()=>[p("Clear Report")]),_:1},8,["onClick"]),o(s,{type:"primary",onClick:t.runReport},{default:m(()=>[p("Run Report")]),_:1},8,["onClick"]),C,t.shiftReport?(f(),h("div",w,[l("div",null,"Account: "+u(t.shiftReport.account.username),1),l("div",null,"Start Time: "+u(t.shiftReport.report_start),1),l("div",null,"EndTime: "+u(t.shiftReport.report_end),1),(f(!0),h(T,null,D(t.shiftReport.report_by_payment_type,r=>(f(),h("div",null,[N,l("div",null,"Payment Type: "+u(r.payment_type_title),1),l("div",null,"Total: "+u(r.total.toFixed(2)),1),o(y,null,{default:m(()=>[o(Y,{title:"Detail"},{default:m(()=>[o(c,{size:"small",data:r.payments},{default:m(()=>[o(a,{prop:"datetime_posted",width:"150",label:"Posted Datetime"}),o(a,{prop:"payment_title",width:"100",label:"Type"}),o(a,{prop:"total",width:"120",label:"Total"}),o(a,{prop:"last_name",width:"150",label:"Last Name"}),o(a,{prop:"first_name",width:"150",label:"First Name"}),o(a,{prop:"folio",width:"120",label:"Folio"})]),_:2},1032,["data"])]),_:2},1024)]),_:2},1024)]))),256)),o(s,{type:"primary",onClick:t.generatePdf},{default:m(()=>[p("Generate Pdf")]),_:1},8,["onClick"])])):S("",!0)],64)}const P=F(v,[["render",V]]);export{P as default};
