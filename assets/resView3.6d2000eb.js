import{_ as D,r as T,l as B,o as p,c as g,w as i,a as o,b as c,d as S,n as L,e as k,t as _,F as z,p as Q,f as O,g as f,h as V,i as R,j as v,k as C,E as x,m as N,q as I,s as Y,S as H,u as G,v as K,x as E,y as $,z as j,A as W,B as J,C as X,D as Z,G as ee,H as te,I as se}from"./index.b42f938c.js";const le={name:"singelDatePicker",props:["overrideDate"],emits:["singleDatePicker:dateSelected"],data(){return{selectedDate:T().startDate,size:"default"}},computed:{datepickerPlaceholder(){return this.$t("message.datepickerPlaceholder")},locale(){return B().selectedLocale}},watch:{overrideDate(e){this.selectedDate=e},selectedDate(e,t){this.$emit("singleDatePicker:dateSelected",this.selectedDate)}}};function ae(e,t,a,r,s,l){const n=c("el-date-picker"),d=c("el-config-provider");return p(),g(d,{locale:l.locale},{default:i(()=>[o(n,{modelValue:s.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=u=>s.selectedDate=u),type:"date",format:"D-MMM-YYYY",placeholder:l.datepickerPlaceholder,size:s.size},null,8,["modelValue","placeholder","size"])]),_:1},8,["locale"])}const oe=D(le,[["render",ae]]);const ne={props:["isFirst","isLast","resId","start","end","name","span","startTruncated","endTruncated","status"],name:"resBlock",emits:["resBlockClick"],data(){return{}},computed:{classGenerate(){return"resblock-"+this.resId},shortName(){return this.name.length>7?this.name.substring(0,7)+"...":this.name}},methods:{resClicked(e){this.$emit("resBlockClick",e)}}},F=e=>(Q("data-v-f87405b0"),e=e(),O(),e),ie={key:0},re=F(()=>f("b",null,"<",-1)),ce=[re],de={key:1},ue={key:2,class:"float-right"},pe=F(()=>f("b",null,">",-1)),me=[pe],he=F(()=>f("span",{class:"sameAsCheckoutBackground"},".",-1)),fe={key:0},_e=F(()=>f("b",null,"<",-1)),ge=[_e],ye={key:1},Se={key:2,class:"float-right"},ve=F(()=>f("b",null,">",-1)),ke=[ve],be=F(()=>f("span",{class:"sameAsCheckinBackground"},".",-1));function we(e,t,a,r,s,l){return p(),S(z,null,[a.status==0?(p(),S("div",{key:0,class:L([l.classGenerate,"resBlockCheckedOut res-block"]),onClick:t[0]||(t[0]=n=>l.resClicked(a.resId))},[a.startTruncated&&a.isFirst?(p(),S("span",ie,ce)):k("",!0),a.isFirst?(p(),S("span",de,_(l.shortName),1)):k("",!0),a.endTruncated&&a.isLast?(p(),S("span",ue,me)):k("",!0),he],2)):k("",!0),a.status==1?(p(),S("div",{key:1,class:L([l.classGenerate,"resBlockCheckedIn res-block"]),onClick:t[1]||(t[1]=n=>l.resClicked(a.resId))},[a.startTruncated&&a.isFirst?(p(),S("span",fe,ge)):k("",!0),a.isFirst?(p(),S("span",ye,_(l.shortName),1)):k("",!0),a.endTruncated&&a.isLast?(p(),S("span",Se,ke)):k("",!0),be],2)):k("",!0)],64)}const Ce=D(ne,[["render",we],["__scopeId","data-v-f87405b0"]]);const Re={props:["resIdRef","start","end","span","startTruncated","blockIndicator"],name:"emptyBlock",emits:["empty-block-click"],methods:{emptyBlockClick(){console.log("emptyBlockClick @emptyBlock"),this.$emit("empty-block-click")}}};function Pe(e,t,a,r,s,l){return p(),S("div",{onClick:t[0]||(t[0]=(...n)=>l.emptyBlockClick&&l.emptyBlockClick(...n)),class:"emptyBlock"},[f("span",null,"blocked"+_(a.resIdRef),1)])}const De=D(Re,[["render",Pe]]);const Te={props:["unassignedResArr"],name:"unassignedBlock",emits:["unassigned-block-select-res"],computed:{resQuantity(){return this.unassignedResArr.length.toString()}},data(){return{selectedUnassignedRes:null}},methods:{unassignedResSelect(e){this.$emit("unassigned-block-select-res",e)}}},ze={class:"unassignedBlock"},Ve=["onClick"];function Ie(e,t,a,r,s,l){const n=c("font-awesome-icon"),d=c("el-button"),u=c("el-dropdown-item"),h=c("el-dropdown-menu"),y=c("el-dropdown");return p(),S("div",ze,[o(y,{trigger:"click"},{dropdown:i(()=>[o(h,null,{default:i(()=>[(p(!0),S(z,null,V(a.unassignedResArr,m=>(p(),g(u,null,{default:i(()=>[f("div",{onClick:b=>l.unassignedResSelect(m.id)},_(m.customer_last),9,Ve)]),_:2},1024))),256))]),_:1})]),default:i(()=>[o(d,{type:"danger"},{default:i(()=>[R(_(l.resQuantity)+"\xA0",1),o(n,{icon:"fa-solid fa-arrow-down"})]),_:1})]),_:1})])}const Me=D(Te,[["render",Ie]]),Ye={name:"c1",props:["spaceId","showChildren","children"],emits:["c1-toggle-show-children"],computed:{hasChildren(){return this.children.length>0}},methods:{divClick(e){return console.log("divClick",this.spaceId),this.$emit("c1-toggle-show-children",this.spaceId),!1}}};const Ne={key:0};function xe(e,t){const a=c("font-awesome-icon"),r=c("el-button");return p(),S("div",{onClick:t[0]||(t[0]=(...s)=>e.divClick&&e.divClick(...s)),class:"c1-wrapper"},[e.hasChildren?(p(),S("div",Ne,[e.showChildren==0?(p(),g(r,{key:0,class:"eButton",type:"primary",plain:"",size:"small"},{default:i(()=>[o(a,{icon:"fa-chevron-right",size:"sm"})]),_:1})):k("",!0),e.showChildren==1?(p(),g(r,{key:1,class:"eButton",type:"primary",plain:"",size:"small"},{default:i(()=>[o(a,{icon:"fa-chevron-down",size:"sm"})]),_:1})):k("",!0)])):k("",!0)])}const Be=D(Ye,[["render",xe],["__scopeId","data-v-5823ffe0"]]),Fe={name:"ResViewTable",components:{c1:Be,resBlock:Ce,emptyBlock:De,unassignedBlock:Me},emits:["resview-toggle-show-children","resBlockClick","emptyBlockClick","emptyCellClick","unassigned-res-selected"],props:["tDateArray","tableData","trigger","resSpaceCopy","tableHeight"],data(){return{}},computed:{spaceLabel(){return this.$t("message.spaceLabel")}},methods:{setInitialScroll(){T().scrollTop>0&&this.setScrollTop(T().scrollTop),T().scrollLeft>0&&this.setScrollLeft(T().scrollLeft)},setScrollLeft(e){this.$refs.resViewTable.$refs.scrollBarRef.setScrollLeft(e)},setScrollTop(e){this.$refs.resViewTable.$refs.scrollBarRef.setScrollTop(e)},c1ToggleShowChildren(e){console.log("resViewTable toggle",e),this.$emit("resview-toggle-show-children",e)},cellClick(e,t){let r=t.property+"resid";if(!e[r]){let s={spaceId:e.id,selectedDate:v(t.property.substr(1)).format("YYYY-MM-DD")};t.property!="description"&&t.property!="expand"&&this.$emit("emptyCellClick",s)}},emptyBlockClick(e,t){console.log("emptyBlockClick on resViewTable",e,t)},getChildrenIds(e){const t=[],a=r=>{let s=C.find(this.resSpaceCopy,l=>l.childOf==r);if(s)C.each(s,l=>{console.log("child",l.id),t.push(l.id),a(l.id)});else return console.log("cArr",t),t};a(e)},resBlockClick(e){this.$emit("resBlockClick",e)},rowStyle(e){if(e.row.childOf>0)return C.find(this.tableData,a=>a.id==e.row.childOf).showChildren==!0?"":"display: none;"},unassignedResSelect(e){this.$emit("unassigned-res-selected",e)}},mounted(){setTimeout(this.setInitialScroll,1),this.$refs.resViewTable.$refs.scrollBarRef.wrapRef.onscroll=e=>{T().scrollLeft=e.target.scrollLeft,T().scrollTop=e.target.scrollTop}},watch:{resSpaceCopy(e,t){console.log("resSpaceCopy change on resViewTable")},tableData(){console.log("tableData wach triggered on resViewTable")},trigger(){console.log("trigger watch on resViewTable",this.trigger)}}};const Ee={"data-rel-day":"0",style:{display:"flex","align-items":"center"}},Ae={style:{display:"flex","align-items":"center"}};function Le(e,t){const a=c("el-table-column"),r=c("c1"),s=c("resBlock"),l=c("emptyBlock"),n=c("unassignedBlock"),d=c("el-table");return p(),g(d,{ref:"resViewTable",data:e.tableData,"row-style":e.rowStyle,height:e.tableHeight,"row-class-name":"resview-row","cell-class-name":"resview-table-cell","header-cell-class-name":"resview-header-cell","header-row-class-name":"resview-header-row",style:{width:"100%",padding:"0px"},onCellClick:e.cellClick,onEmptyBlockClick:e.emptyBlockClick},{default:i(()=>[o(a,{fixed:"",prop:"title",label:e.spaceLabel,width:"120"},null,8,["label"]),o(a,{prop:"expand",fixed:"",width:"27"},{default:i(u=>[f("div",Ee,[o(r,{spaceId:u.row.id,showChildren:u.row.showChildren,children:u.row.children,onC1ToggleShowChildren:e.c1ToggleShowChildren},null,8,["spaceId","showChildren","children","onC1ToggleShowChildren"])])]),_:1}),(p(!0),S(z,null,V(e.tDateArray,u=>(p(),g(a,{prop:u.dayString,label:u.dayLabel,width:"90"},{default:i(h=>[f("div",Ae,[h.row[u.dayString+"resid"]?(p(),g(s,{key:0,onResBlockClick:e.resBlockClick,resId:h.row[u.dayString+"resid"],start:h.row[u.dayString+"start"],end:h.row[u.dayString+"end"],name:h.row[u.dayString+"customer"],span:h.row[u.dayString+"span"],startTruncated:h.row[u.dayString+"starttruncated"],endTruncated:h.row[u.dayString+"endtruncated"],isFirst:h.row[u.dayString+"isfirst"],isLast:h.row[u.dayString+"islast"],status:h.row[u.dayString+"status"]},null,8,["onResBlockClick","resId","start","end","name","span","startTruncated","endTruncated","isFirst","isLast","status"])):k("",!0),h.row[u.dayString+"blocked"]?(p(),g(l,{key:1,onEmptyBlockClick:e.emptyBlockClick,resIdRef:h.row[u.dayString+"resIdRef"],start:h.row[u.dayString+"start"],end:h.row[u.dayString+"end"],span:h.row[u.dayString+"span"],startTruncated:h.row[u.dayString+"starttruncated"],endTruncated:h.row[u.dayString+"endtruncated"]},null,8,["onEmptyBlockClick","resIdRef","start","end","span","startTruncated","endTruncated"])):k("",!0),h.row[u.dayString+"unassigned"]?(p(),g(n,{key:2,onUnassignedBlockSelectRes:e.unassignedResSelect,unassignedResArr:h.row[u.dayString+"unassigned"]},null,8,["onUnassignedBlockSelectRes","unassignedResArr"])):k("",!0)])]),_:2},1032,["prop","label"]))),256))]),_:1},8,["data","row-style","height","onCellClick","onEmptyBlockClick"])}const Ke=D(Fe,[["render",Le]]),$e={name:"DateRangePicker",props:["componentKey","initialStart","initialEnd"],emits:["dateRangePicker:rangeSelected","dateRangePicker:clearDates"],data(){return{dRange:null}},computed:{endDate(){return this.dRange?v(this.dRange[1]).format("YYYY-MM-DD"):null},endPlaceholder(){return this.$t("message.endDate")},labelDates(){return this.$t("message.dates")},locale(){return B().selectedLocale},rSeperator(){return this.$t("message.to")},startDate(){return this.dRange?v(this.dRange[0]).format("YYYY-MM-DD"):null},startPlaceholder(){return this.$t("message.startDate")}},mounted(){this.initialStart&&this.initialEnd&&(this.dRange=[this.initialStart,this.initialEnd])},watch:{componentKey(e){this.dRange=null,this.$emit("dateRangePicker:rangeSelected",[null,null])},dRange(e,t){if(this.startDate!=null&&this.endDate!=null)if(this.startDate==this.endDate)x({type:"warning",message:"Start and end must be different"}),this.$emit("dateRangePicker:clearDates");else{const a=[v(this.dRange[0]).format("YYYY-MM-DD"),v(this.dRange[1]).format("YYYY-MM-DD")];this.$emit("dateRangePicker:rangeSelected",a)}}}};function Ue(e,t,a,r,s,l){const n=c("el-date-picker"),d=c("el-form-item"),u=c("el-form"),h=c("el-config-provider");return p(),S("div",null,[o(h,{locale:l.locale},{default:i(()=>[o(u,{"label-width":"120px",size:"small"},{default:i(()=>[o(d,{label:l.labelDates},{default:i(()=>[o(n,{modelValue:s.dRange,"onUpdate:modelValue":t[0]||(t[0]=y=>s.dRange=y),type:"daterange",size:"small",format:"D-MMM-YYYY",clearable:!1,"range-separator":l.rSeperator,"start-placeholder":l.startPlaceholder,"end-placeholder":l.endPlaceholder},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["locale"])])}const qe=D($e,[["render",Ue]]),Qe={name:"RootSpacePicker",props:["availableSpaceIds","componentKey"],emits:["rootSpacePicker:spaceSelected"],data(){return{rootSpaces:null,selectedRootSpace:null}},computed:{availableSpaces(){if(this.rootSpaces&&this.availableSpaceIds){let e=[];return C.each(this.rootSpaces,t=>{C.includes(this.availableSpaceIds,t.id)&&e.push(t)}),e}else return[]},initialSpaceIdSelected(){return!!this.selectedSpaceId},labelSpace(){return this.$t("message.spaceLabel")},locale(){return this.$i18n},placeholder(){return this.$t("message.select")},token(){return N().token}},created(){I.rootSpaces.getRootSpaces(this.token).then(e=>{this.rootSpaces=e.data.root_spaces_children_parents})},watch:{componentKey(e){console.log("cKey on rSP"),this.selectedRootSpace=null},selectedRootSpace(e,t){this.$emit("rootSpacePicker:spaceSelected",this.selectedRootSpace)},availableSpaceIds(e,t){this.selectedRootSpace=null}}};function Oe(e,t,a,r,s,l){const n=c("el-option"),d=c("el-select"),u=c("el-config-provider"),h=c("el-form-item"),y=c("el-form");return p(),S("div",null,[o(y,{"label-width":"120px",size:"small",class:"cust-form"},{default:i(()=>[o(h,{label:l.labelSpace},{default:i(()=>[o(u,{locale:l.locale},{default:i(()=>[s.rootSpaces?(p(),g(d,{key:0,modelValue:s.selectedRootSpace,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedRootSpace=m),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(l.availableSpaces,m=>(p(),g(n,{label:m.title,value:m.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])):k("",!0)]),_:1},8,["locale"])]),_:1},8,["label"])]),_:1})])}const He=D(Qe,[["render",Oe]]),Ge={name:"SearchCustomers",props:["componentKey"],emits:["searchCustomers:customerSelected"],data(){return{customers:[],form:{firstName:"",lastName:""},currentPage:1,pageSize:10,rowCount:0}},computed:{labelCustomer(){return this.$t("message.customer")},labelFirstName(){return this.$t("message.firstName")},labelLastName(){return this.$t("message.lastName")},offset(){return(this.currentPage-1)*this.pageSize},token(){return N().token}},methods:{searchC(){try{I.customers.searchCustomers(this.form.lastName,this.form.firstName,this.token,this.offset,this.pageSize).then(e=>{console.log(e.data),this.customers=e.data.customers,this.rowCount=e.data.count}).catch(e=>{Y({message:e,type:"warning"})})}catch{Y({message:"Error requesting data from server",type:"warning"})}},selectCustomer(e){this.$emit("searchCustomers:customerSelected",e)}},watch:{componentKey(e){this.form.firstName="",this.form.lastName="",this.rowCount=0,this.customers=[]},currentPage(e){this.currentPage=e},offset(e){this.searchC()},pageSize(e){this.searchC()}}};function je(e,t,a,r,s,l){const n=c("el-input"),d=c("el-col"),u=c("el-form-item"),h=c("el-button"),y=c("el-form"),m=c("el-table-column"),b=c("el-table"),w=c("el-pagination"),M=c("el-config-provider");return p(),g(M,null,{default:i(()=>[o(y,{"label-width":"120px",size:"small"},{default:i(()=>[o(u,{label:l.labelCustomer},{default:i(()=>[o(d,{span:11},{default:i(()=>[o(n,{modelValue:s.form.lastName,"onUpdate:modelValue":t[0]||(t[0]=P=>s.form.lastName=P),placeholder:l.labelLastName},null,8,["modelValue","placeholder"])]),_:1}),o(d,{span:11},{default:i(()=>[o(n,{modelValue:s.form.firstName,"onUpdate:modelValue":t[1]||(t[1]=P=>s.form.firstName=P),placeholder:l.labelFirstName},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),o(u,null,{default:i(()=>[o(h,{type:"primary",onClick:l.searchC},{default:i(()=>[R(_(e.$t("message.searchCustomers")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),o(b,{data:s.customers,size:"small",style:{width:"100%"},height:"200px",onRowClick:l.selectCustomer},{default:i(()=>[o(m,{fixed:"",prop:"last_name",label:l.labelLastName,width:"100"},null,8,["label"]),o(m,{fixed:"",prop:"first_name",label:l.labelFirstName,width:"100"},null,8,["label"]),o(m,{prop:"email",label:"Email",width:"120"}),o(m,{prop:"address1",label:"Address 1",width:"120"}),o(m,{prop:"address2",label:"Address 2",width:"120"}),o(m,{prop:"city",label:"City",width:"120"}),o(m,{prop:"region",label:"Region",width:"120"}),o(m,{prop:"country",label:"Country",width:"120"}),o(m,{prop:"postalCode",label:"PostalCode",width:"120"})]),_:1},8,["data","onRowClick"]),o(w,{"current-page":s.currentPage,"onUpdate:current-page":t[2]||(t[2]=P=>s.currentPage=P),"page-size":s.pageSize,"onUpdate:page-size":t[3]||(t[3]=P=>s.pageSize=P),background:"",layout:"sizes, prev, pager, next",total:s.rowCount,"page-sizes":[1,10,20,30,40,50]},null,8,["current-page","page-size","total"])]),_:1})}const U=D(Ge,[["render",je]]);H.warning=function(){};const We={name:"CreateCustomer",props:["componentKey"],emits:["createCustomer:customerCreated"],data(){return{customerForm:{firstName:"",lastName:"",email:"",phone:""},rules:{firstName:[{required:!0,message:()=>this.$t("message.firstNameIsRequired")},{min:1,max:24,message:"1 to 24"}],lastName:[{required:!0,message:()=>this.$t("message.lastNameIsRequired")},{min:2,max:24,message:"2 to 24"}],email:[{type:"email",message:()=>this.$t("message.enterCorrectEmail")}],phone:[{pattern:/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/,message:"enter a correct phone"}]}}},computed:{labelEmail(){return this.$t("message.email")},labelFirstName(){return this.$t("message.firstName")},labelLastName(){return this.$t("message.lastName")},labelPhone(){return this.$t("message.phone")},locale(){return B().selectedLocale},token(){return N().token}},methods:{submitForm(e){this.$refs[e].validate(t=>{if(t)I.customers.createCustomer(this.token,this.customerForm.lastName,this.customerForm.firstName,this.customerForm.email,this.customerForm.phone).then(a=>{console.log(a),a.data.createCustomer&&a.data.newCustomer&&this.$emit("createCustomer:customerCreated",a.data.newCustomer)});else return console.log("error submit!!"),!1})},resetForm(e){this.$refs[e].resetFields()}},watch:{componentKey(e){this.customerForm.firstName="",this.customerForm.lastName="",this.customerForm.email="",this.customerForm.phone=""}}};function Je(e,t,a,r,s,l){const n=c("el-input"),d=c("el-form-item"),u=c("el-button"),h=c("el-form"),y=c("el-config-provider");return p(),g(y,{locale:l.locale},{default:i(()=>[o(h,{model:s.customerForm,rules:s.rules,size:"small",ref:"createCustomerForm","label-width":"120px"},{default:i(()=>[o(d,{label:l.labelFirstName,prop:"firstName"},{default:i(()=>[o(n,{modelValue:s.customerForm.firstName,"onUpdate:modelValue":t[0]||(t[0]=m=>s.customerForm.firstName=m)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:l.labelLastName,prop:"lastName"},{default:i(()=>[o(n,{modelValue:s.customerForm.lastName,"onUpdate:modelValue":t[1]||(t[1]=m=>s.customerForm.lastName=m)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:l.labelEmail,prop:"email"},{default:i(()=>[o(n,{modelValue:s.customerForm.email,"onUpdate:modelValue":t[2]||(t[2]=m=>s.customerForm.email=m)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:l.labelPhone,prop:"phone"},{default:i(()=>[o(n,{modelValue:s.customerForm.phone,"onUpdate:modelValue":t[3]||(t[3]=m=>s.customerForm.phone=m)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,null,{default:i(()=>[o(u,{type:"primary",onClick:t[4]||(t[4]=m=>l.submitForm("createCustomerForm"))},{default:i(()=>[R(_(e.$t("message.createCustomer")),1)]),_:1}),o(u,{onClick:t[5]||(t[5]=m=>l.resetForm("createCustomerForm"))},{default:i(()=>[R(_(e.$t("message.reset")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["locale"])}const q=D(We,[["render",Je]]),Xe={name:"ResBedsPicker",props:["componentKey","initialBedsQty"],emits:["resBedsPicker:bedQtyChosen"],data(){return{arr:[1,2,3,4,5,6,7,8,9,10],selectedBedQty:null}},computed:{labelNumberOfBeds(){return this.$t("message.numberOfBeds")},locale(){return this.$i18n},placeholder(){return this.$t("message.select")}},mounted(){this.initialBedsQty&&(this.selectedBedQty=this.initialBedsQty)},watch:{componentKey(e){this.selectedBedQty=null},selectedBedQty(e,t){this.$emit("resBedsPicker:bedQtyChosen",this.selectedBedQty)}}};function Ze(e,t,a,r,s,l){const n=c("el-option"),d=c("el-select"),u=c("el-form-item"),h=c("el-form"),y=c("el-config-provider");return p(),S("div",null,[o(y,null,{default:i(()=>[o(h,{"label-width":"120px",size:"small"},{default:i(()=>[o(u,{label:l.labelNumberOfBeds},{default:i(()=>[o(d,{modelValue:s.selectedBedQty,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedBedQty=m),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(s.arr,m=>(p(),g(n,{label:m,value:m},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})])}const et=D(Xe,[["render",Ze]]),tt={name:"ResPeoplePicker",props:["componentKey","initialPeopleQty"],emits:["resPeoplePicker:peopleQtyChosen"],data(){return{arr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],selectedPeopleQty:null}},computed:{labelPeople(){return this.$t("message.people")},locale(){return B().selectedLocale},placeholder(){return this.$t("message.select")}},mounted(){this.initialPeopleQty&&(this.selectedPeopleQty=this.initialPeopleQty)},watch:{componentKey(e,t){console.log("componentKey change on resPoeplePic",t),this.selectedPeopleQty=null},selectedPeopleQty(e,t){console.log(this.$i18n),this.$emit("resPeoplePicker:peopleQtyChosen",this.selectedPeopleQty)}}};function st(e,t,a,r,s,l){const n=c("el-option"),d=c("el-select"),u=c("el-form-item"),h=c("el-form"),y=c("el-config-provider");return p(),S("div",null,[o(y,{locale:l.locale},{default:i(()=>[o(h,{"label-width":"120px",size:"small"},{default:i(()=>[o(u,{label:l.labelPeople},{default:i(()=>[o(d,{modelValue:s.selectedPeopleQty,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedPeopleQty=m),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(s.arr,m=>(p(),g(n,{label:m,value:m},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["locale"])])}const lt=D(tt,[["render",st]]),A=()=>{const e=()=>{N().setAccountToGuest(),G.push({path:"/Login"})};return{handleRequestError:a=>{if(a)if(a.response)if(a.response.status)switch(a.response.status){case 400:Y({title:"Error 400 - Bad Request",duration:0,message:"The request was malformed.  Request was not processed",type:"error"});break;case 401:Y({title:"Error 401 - Unauthorized",duration:4500,message:"Authorization failed.  Request was not processed.",type:"error",onClose:e});break;case 403:Y({title:"Error 403 - Forbidden",duration:0,message:"You are not allowed to perform this task.  Request was not processed",type:"error",onClose:e});break;case 404:Y({title:"Error 404 - Not found",duration:4500,message:"The location of this this request was not found",type:"error"});case 500:Y({title:"Server Error",duration:4500,message:"There was an error on the server.  Request was not processed",type:"error"});break;default:Y({title:"Error",duration:4500,message:"There was an error.  Request was not processed",type:"error"})}else Y({title:"Error",duration:4500,message:"There was an error.  Request was not processed",type:"error"});else Y({title:"Error",duration:0,message:"There was an error 1.  Request was not processed",type:"error"});else Y({title:"Error",duration:0,message:"There was an error 2.  Request was not processed",type:"error"})}}},at={setup(){const{handleRequestError:e}=A();return{handleRequestError:e}},name:"CreateReservation",emits:["createReservation:reloadReservations","createReservation:closeDrawer"],components:{DateRangePicker:qe,RootSpacePicker:He,SearchCustomers:U,CreateCustomer:q,ResBedsPicker:et,ResPeoplePicker:lt},data(){return{availableSpaceIds:null,isAssigned:1,selectedCustomer:null,showCreateCustomer:!1,showSearchCustomers:!1,spaceTypePref:0,startDate:null,endDate:null,selectedSpaceId:null,selectedPeople:null,selectedBeds:null,componentKey:0}},computed:{labelCustomer(){return this.$t("message.customer")},fStartDate(){return this.startDate?v(this.startDate).format("YYYY-MM-DD"):null},fEndDate(){return this.endDate?v(this.endDate).format("YYYY-MM-DD"):null},spaceTypes(){return K().spaceTypes},token(){return N().token},labelAssigned(){return this.$t("message.assigned")},labelFalse(){return this.$t("message.false")},labelTrue(){return this.$t("message.true")},typeLabel(){return this.$t("message.type")}},methods:{bedQtyChosen(e){console.log("gotem beds on create res",e),this.selectedBeds=e},checkConflicts(){I.reservations.checkConflicts(this.fStartDate,this.fEndDate,this.selectedSpaceId,this.token).then(e=>{console.log(e)}).catch(e=>{handleError(e)})},createReservation(){let e;this.spaceTypePref?e=this.spaceTypePref:e=0,I.reservations.createReservation(this.token,this.fStartDate,this.fEndDate,this.selectedCustomer,this.selectedSpaceId,this.selectedPeople,this.selectedBeds,this.isAssigned,e).then(t=>{t.data.create.execute_res_sql==!0&&(x({type:"success",message:"Reservation was created"}),this.$emit("createReservation:reloadReservations"),this.resetForm())}).catch(t=>{this.handleRequestError(t)})},customerSelected(e){this.selectedCustomer=e},dRangeClearDates(){this.startDate=null,this.endDate=null,this.availableSpaceIds=null},dRangeSelected(e){console.log("dRange @ change on createres",e),e[0]&&e[1]?(this.startDate=e[0],this.endDate=e[1],I.reservations.checkAvailabilityByDates(this.fStartDate,this.fEndDate,this.token).then(t=>{console.log(t.data),this.availableSpaceIds=t.data.availability.availableSpaceIds})):(this.availableSpaceIds=[],this.startDate=null,this.endDate=null)},peopleQtyChosen(e){this.selectedPeople=e},resetForm(){this.componentKey+=1,this.availableSpaceIds=[],this.selectedCustomer=null,this.showCreateCustomer=!1,this.showSearchCustomers=!1,this.isAssigned=1,this.spaceTypePref=null,this.selectedSpaceId=null},spaceSelected(e){this.selectedSpaceId=e}},watch:{isAssigned(e,t){this.selectedSpaceId=null,this.spaceTypePref=0}}},ot=f("hr",null,null,-1),nt={key:0},it={key:0},rt=f("hr",null,null,-1);function ct(e,t){const a=c("el-button"),r=c("el-form-item"),s=c("el-form"),l=c("SearchCustomers"),n=c("CreateCustomer"),d=c("ResPeoplePicker"),u=c("ResBedsPicker"),h=c("DateRangePicker"),y=c("RootSpacePicker"),m=c("el-option"),b=c("el-select"),w=c("el-col"),M=c("el-row");return p(),g(M,null,{default:i(()=>[o(w,null,{default:i(()=>[f("h1",null,_(e.$t("message.createReservation")),1),o(a,{type:"primary",size:"small",onClick:e.resetForm},{default:i(()=>[R("Reset Form")]),_:1},8,["onClick"]),f("div",null,"spaceId: "+_(e.selectedSpaceId),1),f("div",null,"spaceTypePref: "+_(e.spaceTypePref),1),f("div",null,"isAssigned: "+_(e.isAssigned),1),ot,f("div",null,[f("span",null,[e.selectedCustomer?(p(),S("span",nt,[R(_(e.$t("message.customer"))+":\xA0",1),f("b",null,_(e.selectedCustomer.first_name)+"\xA0"+_(e.selectedCustomer.last_name),1)])):k("",!0),e.selectedCustomer?(p(),g(a,{key:1,type:"warning",size:"small",style:{float:"right"},onClick:t[0]||(t[0]=P=>{e.selectedCustomer=null,e.showSearchCustomers=null,e.showCreateCustomer=null})},{default:i(()=>[R(_(e.$t("message.reset")),1)]),_:1})):k("",!0)])]),f("div",null,[e.selectedCustomer?k("",!0):(p(),S("span",it,[o(s,{size:"small"},{default:i(()=>[o(r,{label:e.labelCustomer},{default:i(()=>[o(a,{size:"small",type:"primary",onClick:t[1]||(t[1]=P=>{e.showSearchCustomers=!0,e.showCreateCustomer=!1})},{default:i(()=>[R(_(e.$t("message.search")),1)]),_:1}),o(a,{size:"small",type:"primary",onClick:t[2]||(t[2]=P=>{e.showCreateCustomer=!0,e.showSearchCustomers=!1})},{default:i(()=>[R(_(e.$t("message.create")),1)]),_:1})]),_:1},8,["label"])]),_:1})]))]),e.showSearchCustomers&&!e.selectedCustomer?(p(),g(l,{key:0,componentKey:e.componentKey,"onSearchCustomers:customerSelected":e.customerSelected},null,8,["componentKey","onSearchCustomers:customerSelected"])):k("",!0),e.showCreateCustomer&&!e.selectedCustomer?(p(),g(n,{key:1,componentKey:e.componentKey,"onCreateCustomer:customerCreated":e.customerSelected},null,8,["componentKey","onCreateCustomer:customerCreated"])):k("",!0),rt,o(d,{componentKey:e.componentKey,"onResPeoplePicker:peopleQtyChosen":e.peopleQtyChosen},null,8,["componentKey","onResPeoplePicker:peopleQtyChosen"]),o(u,{componentKey:e.componentKey,"onResBedsPicker:bedQtyChosen":e.bedQtyChosen},null,8,["componentKey","onResBedsPicker:bedQtyChosen"]),o(h,{componentKey:e.componentKey,"onDateRangePicker:rangeSelected":e.dRangeSelected,"onDateRangePicker:clearDates":e.dRangeClearDates},null,8,["componentKey","onDateRangePicker:rangeSelected","onDateRangePicker:clearDates"]),e.availableSpaceIds&&e.isAssigned?(p(),g(y,{key:2,componentKey:e.componentKey,availableSpaceIds:e.availableSpaceIds,"onRootSpacePicker:spaceSelected":e.spaceSelected},null,8,["componentKey","availableSpaceIds","onRootSpacePicker:spaceSelected"])):k("",!0),o(s,{size:"small","label-width":"120px"},{default:i(()=>[o(r,{label:e.labelAssigned},{default:i(()=>[o(b,{modelValue:e.isAssigned,"onUpdate:modelValue":t[3]||(t[3]=P=>e.isAssigned=P)},{default:i(()=>[o(m,{label:e.labelTrue,value:1},null,8,["label"]),o(m,{label:e.labelFalse,value:0},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),e.isAssigned?k("",!0):(p(),g(r,{key:0,label:e.typeLabel},{default:i(()=>[o(b,{modelValue:e.spaceTypePref,"onUpdate:modelValue":t[4]||(t[4]=P=>e.spaceTypePref=P)},{default:i(()=>[(p(!0),S(z,null,V(e.spaceTypes,P=>(p(),g(m,{label:P.title,value:P.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label"]))]),_:1}),e.startDate&&e.endDate&&e.selectedCustomer&&e.selectedPeople&&e.selectedBeds&&(e.selectedSpaceId||!e.isAssigned&&e.spaceTypePref)?(p(),g(r,{key:3},{default:i(()=>[o(a,{type:"primary",size:"small",onClick:e.createReservation},{default:i(()=>[R(_(e.$t("message.createReservation")),1)]),_:1},8,["onClick"]),o(a,{type:"primary",size:"small",onClick:e.checkConflicts},{default:i(()=>[R(_(e.$t("message.availability")),1)]),_:1},8,["onClick"])]),_:1})):k("",!0)]),_:1})]),_:1})}const dt=D(at,[["render",ct]]),ut={name:"EditReservation",props:["componentKey","resId","checkin","checkout","people","beds","isAssigned","spaceTypePref","spaceId","customer","customerFirst","customerLast"],emits:["edit-reservation:modify-reservation-1"],components:{SearchCustomers:U,CreateCustomer:q},data(){return{cResId:this.resId,cCheckin:this.checkin,cCheckout:this.checkout,cPeople:this.people,cBeds:this.beds,cIsAssigned:this.isAssigned,cSpaceTypePref:this.spaceTypePref,cSpaceId:this.spaceId,cCustomer:this.customer,cCustomerFirst:this.customerFirst,cCustomerLast:this.customerLast,componentKey2:0,availableSpaceIds:[],availableSpaces:[],showCreateCustomer:!1,showSearchCustomers:!1,selectedSpace:"",bedsSelectArr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],peopleSelectArr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}},computed:{bedsPickerLabel(){return this.$t("message.beds")},cCheckinF(){return v(this.cDateRange[0]).format("YYYY-MM-DD")},cCheckoutF(){return v(this.cDateRange[1]).format("YYYY-MM-DD")},cDateRange:{get(){return[this.cCheckin,this.cCheckout]},set(e){this.cCheckin=v(e[0]).format("YYYY-MM-DD"),this.cCheckout=v(e[1]).format("YYYY-MM-DD")}},editReady(){return!!(this.selectedSpace||!this.cIsAssigned&&this.cSpaceTypePref)},labelAssigned(){return this.$t("message.assigned")},labelFalse(){return this.$t("message.false")},labelTrue(){return this.$t("message.true")},locale(){return B().selectedLocale},notAssignedTxt(){return this.$t("message.notAssigned")},rootSpaces(){return{...E().rootSpaces}},spaceTypes(){return K().spaceTypes},token(){return N().token},peoplePickerLabel(){return this.$t("message.people")},placeholder(){return this.$t("message.select")},rangePickerEndPlaceholder(){return this.$t("message.endDate")},rangePickerLabelDates(){return this.$t("message.dates")},rangePickerSeperator(){return this.$t("message.to")},rangePickerStartPlaceholder(){return this.$t("message.startDate")},spacePickerLabel(){return this.$t("message.spaceLabel")},typeLabel(){return this.$t("message.type")}},methods:{createCustomerSelected(e){console.log("cust created",e),this.cCustomer=e.id,this.cCustomerFirst=e.firstName,this.cCustomerLast=e.lastName,this.componentKey+=1,this.showCreateCustomer=!1},loadAvailableSpaces(){let e=[];C.each(this.rootSpaces,t=>{C.includes(this.availableSpaceIds,t.id)&&e.push(t)}),this.availableSpaces=e},loadAvailableSpaceIds(){I.reservations.checkAvailabilityByDatesIgnoreRes(this.resId,this.cCheckinF,this.cCheckoutF,this.token).then(e=>{this.availableSpaceIds=e.data.availableSpaceIds,this.loadAvailableSpaces(),this.selectedSpace=null})},revertToProps(){this.cCheckin=this.checkin,this.cCheckout=this.checkout,this.cPeople=this.people,this.cBeds=this.beds,this.cCustomer=this.customer,this.cCustomerFirst=this.customerFirst,this.cCustomerLast=this.customerLast,this.cSpaceTypePref=this.spaceTypePref,this.cIsAssigned=this.isAssigned,this.selectedSpace=null,this.showSearchCustomers=!1,this.showCreateCustomer=!1},searchCustomerSelected(e){console.log(e),this.cCustomer=e.id,this.cCustomerFirst=e.firstName,this.cCustomerLast=e.lastName,this.componentKey2+=1,this.showSearchCustomers=!1},updateReservation(){console.log("THESE ARE current"),console.log("customer",this.cCustomer),console.log("spaceId",this.selectedSpace),console.log("people",this.cPeople),console.log("beds",this.cBeds),console.log("checkin",this.cCheckinF),console.log("checkout",this.cCheckoutF),console.log("customerFirst",this.cCustomerFirst),console.log("customerLast",this.cCustomerLast),console.log("isAssigned",this.cIsAssigned),console.log("spaceTypePref",this.cSpaceTypePref);let e=null;this.cIsAssigned?e=this.selectedSpace:e=0;let t=null;e?t=0:t=this.cSpaceTypePref;const a={res_id:this.cResId,space_id:e,people:this.cPeople,beds:this.cBeds,is_assigned:this.cIsAssigned,space_type_pref:t,checkin:this.cCheckinF,checkout:this.cCheckoutF};console.log("this IS ARGS"),console.table(a),this.$emit("edit-reservation:modify-reservation-1",a)}},mounted(){I.reservations.checkAvailabilityByDatesIgnoreRes(this.resId,this.checkin,this.checkout,this.token).then(e=>{console.log(e),this.availableSpaceIds=e.data.availableSpaceIds,this.loadAvailableSpaces()})},watch:{componentKey(e){this.revertToProps()},resId(e){this.cResId=e},checkin(e){this.cCheckin=e},checkout(e){this.cCheckout=e},people(e){this.cPeople=e},beds(e){this.cBeds=e},isAssigned(e){this.cIsAssigned=e},spaceTypePref(e){this.cSpaceTypePref=e},spaceId(e){this.cSpaceId=e},customer(e){this.cCustomer=e},customerFirst(e){this.cCustomerFirst=e},customerLast(e){this.cCustomerLast=e},cDateRange(e){console.log("cDateRange change",e),this.loadAvailableSpaceIds()},cIsAssigned(e){this.loadAvailableSpaceIds},selectedSpace(e,t){console.log("selectedSpace change",e,t),console.log("cDateRange @ selectedSpace change:"),console.table(this.cDateRange)}}},pt={key:0};function mt(e,t,a,r,s,l){const n=c("el-option"),d=c("el-select"),u=c("el-form-item"),h=c("el-date-picker"),y=c("el-form"),m=c("el-config-provider"),b=c("el-button");return l.rootSpaces?(p(),S("div",pt,[o(m,{locale:l.locale},{default:i(()=>[o(y,{"label-width":"70px",size:"small"},{default:i(()=>[o(u,{label:l.peoplePickerLabel},{default:i(()=>[o(d,{modelValue:s.cPeople,"onUpdate:modelValue":t[0]||(t[0]=w=>s.cPeople=w),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(s.peopleSelectArr,w=>(p(),g(n,{label:w,value:w},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(u,{label:l.bedsPickerLabel},{default:i(()=>[o(d,{modelValue:s.cBeds,"onUpdate:modelValue":t[1]||(t[1]=w=>s.cBeds=w),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(s.bedsSelectArr,w=>(p(),g(n,{label:w,value:w},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(u,{label:l.rangePickerLabelDates},{default:i(()=>[o(h,{modelValue:l.cDateRange,"onUpdate:modelValue":t[2]||(t[2]=w=>l.cDateRange=w),type:"daterange",size:"small",format:"D-MMM-YYYY",clearable:!1,"range-separator":l.rangePickerSeperator,"start-placeholder":l.rangePickerStartPlaceholder,"end-placeholder":l.rangePickerEndPlaceholder},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"])]),_:1},8,["label"]),s.cIsAssigned?(p(),g(u,{key:0,label:l.spacePickerLabel},{default:i(()=>[this.rootSpaces&&this.availableSpaceIds?(p(),g(d,{key:0,modelValue:this.selectedSpace,"onUpdate:modelValue":t[3]||(t[3]=w=>this.selectedSpace=w),placeholder:l.placeholder},{default:i(()=>[(p(!0),S(z,null,V(this.availableSpaces,w=>(p(),g(n,{label:w.title,value:w.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])):k("",!0)]),_:1},8,["label"])):k("",!0),o(u,{label:l.labelAssigned},{default:i(()=>[o(d,{modelValue:s.cIsAssigned,"onUpdate:modelValue":t[4]||(t[4]=w=>s.cIsAssigned=w)},{default:i(()=>[o(n,{label:l.labelTrue,value:1},null,8,["label"]),o(n,{label:l.labelFalse,value:0},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),s.cIsAssigned?k("",!0):(p(),g(u,{key:1,label:l.typeLabel},{default:i(()=>[o(d,{modelValue:s.cSpaceTypePref,"onUpdate:modelValue":t[5]||(t[5]=w=>s.cSpaceTypePref=w)},{default:i(()=>[(p(!0),S(z,null,V(l.spaceTypes,w=>(p(),g(n,{label:w.title,value:w.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label"]))]),_:1})]),_:1},8,["locale"]),f("div",null,[l.editReady?(p(),g(b,{key:0,onClick:l.updateReservation,type:"success"},{default:i(()=>[R("Save")]),_:1},8,["onClick"])):k("",!0),o(b,{onClick:l.revertToProps,type:"info"},{default:i(()=>[R("revert")]),_:1},8,["onClick"])])])):k("",!0)}const ht=D(ut,[["render",mt]]),ft={name:"ProcessSaleType",props:["saleType","processSaleTypeResetKey"],emits:["process-sale-type:add-sale-item"],data(){return{description:"",saleQuantities:[-5,-4,-3,-2,-1,1,2,3,4,5],iSale:null}},computed:{subtotal(){return Number(this.iSale.price*this.iSale.quantity).toFixed(2)},saleTotal(){return this.iSale&&this.subtotal&&this.totalTax?Number(Number(this.subtotal)+Number(this.totalTax)).toFixed(2):null},saleTypes(){return $().saleTypes},taxRate(){if(this.iSale){const e=this.iSale.tax_types;let t=0;return C.each(e,a=>{const r=C.find(this.taxTypes,s=>s.id==a);t=Number(t)+Number(r.tax_rate)}),Number(t)}else return null},taxSpread(){if(this.iSale&&this.subtotal){let e=[];return C.each(this.iSale.tax_types,t=>{let a={};const r=C.find(this.taxTypes,s=>s.id==t);a.i=t,a.r=r.tax_rate,a.t=Number(r.tax_rate*this.subtotal).toFixed(2),e.push(a)}),e}else return null},taxTypes(){return j().taxTypes},totalTax(){return this.taxRate!=null?(this.subtotal*Number(this.taxRate)).toFixed(2):null}},methods:{addToSale(){const e={saleType:this.iSale.id,saleTitle:this.iSale.title,saleQuantity:this.iSale.quantity,salePrice:this.iSale.price,saleSubtotal:this.subtotal,saleTax:this.totalTax,saleTotal:this.saleTotal,taxTypes:this.iSale.tax_types,taxSpread:this.taxSpread,description:this.iSale.description};this.$emit("process-sale-type:add-sale-item",e)}},watch:{saleType(e){console.log("watch on process sale type",e),e?(e.quantity=1,e.description=e.title,e.is_fixed_price?e.price=e.fixed_price:e.price=null,this.iSale=e):this.iSale=null}}},_t={class:"process-sale-wrapper"};function gt(e,t,a,r,s,l){const n=c("el-input"),d=c("el-form-item"),u=c("el-option"),h=c("el-select"),y=c("el-form"),m=c("el-button");return p(),S("div",_t,[s.iSale?(p(),g(y,{key:0,size:"small",inline:!0,"label-position":"top"},{default:i(()=>[o(d,{label:"Type"},{default:i(()=>[o(n,{disabled:"",modelValue:s.iSale.title,"onUpdate:modelValue":t[0]||(t[0]=b=>s.iSale.title=b)},null,8,["modelValue"])]),_:1}),o(d,{label:"Qty",style:{width:"60px"}},{default:i(()=>[o(h,{modelValue:s.iSale.quantity,"onUpdate:modelValue":t[1]||(t[1]=b=>s.iSale.quantity=b)},{default:i(()=>[(p(!0),S(z,null,V(s.saleQuantities,b=>(p(),g(u,{label:b,value:b},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),Boolean(Number(s.iSale.is_fixed_price))?(p(),g(d,{key:0,label:"Amount",style:{width:"80px"}},{default:i(()=>[o(n,{disabled:"",modelValue:s.iSale.price,"onUpdate:modelValue":t[2]||(t[2]=b=>s.iSale.price=b)},null,8,["modelValue"])]),_:1})):k("",!0),Boolean(Number(s.iSale.is_fixed_price))?k("",!0):(p(),g(d,{key:1,label:"Amount",style:{width:"80px"}},{default:i(()=>[o(n,{modelValue:s.iSale.price,"onUpdate:modelValue":t[3]||(t[3]=b=>s.iSale.price=b)},null,8,["modelValue"])]),_:1})),o(d,{label:"Subtotal",style:{width:"80px"}},{default:i(()=>[o(n,{disabled:"",modelValue:l.subtotal,"onUpdate:modelValue":t[4]||(t[4]=b=>l.subtotal=b)},null,8,["modelValue"])]),_:1}),o(d,{label:"Tax",style:{width:"80px"}},{default:i(()=>[o(n,{disabled:"",modelValue:l.totalTax,"onUpdate:modelValue":t[5]||(t[5]=b=>l.totalTax=b)},null,8,["modelValue"])]),_:1}),o(d,{label:"Total",style:{width:"80px"}},{default:i(()=>[o(n,{disabled:"",modelValue:l.saleTotal,"onUpdate:modelValue":t[6]||(t[6]=b=>l.saleTotal=b)},null,8,["modelValue"])]),_:1})]),_:1})):k("",!0),s.iSale?(p(),g(y,{key:1,size:"small"},{default:i(()=>[o(d,{label:"Description"},{default:i(()=>[o(n,{modelValue:s.iSale.description,"onUpdate:modelValue":t[7]||(t[7]=b=>s.iSale.description=b)},null,8,["modelValue"])]),_:1})]),_:1})):k("",!0),l.saleTotal&&l.saleTotal>0||l.saleTotal<0?(p(),g(y,{key:2},{default:i(()=>[o(d,null,{default:i(()=>[o(m,{onClick:l.addToSale,size:"small",type:"success"},{default:i(()=>[R("Add to sale")]),_:1},8,["onClick"])]),_:1})]),_:1})):k("",!0)])}const yt=D(ft,[["render",gt]]),St={name:"SaleItems",props:["saleItems"],emits:["sale-items:remove-at-index"],data(){return{}},computed:{saleItemsExist(){return this.saleItems.length>0}},methods:{handleRemoveItem(e){console.log(e),this.$emit("sale-items:remove-at-index",e.$index)}},watch:{saleItems(e){console.log("new prop on saleItems component",e)}}};function vt(e,t,a,r,s,l){const n=c("el-table-column"),d=c("el-button"),u=c("el-table");return p(),g(u,{size:"small",data:a.saleItems,style:{width:"100%"}},{default:i(()=>[o(n,{prop:"saleTitle",width:"140",label:"Type"}),o(n,{prop:"description",label:"Description"}),o(n,{prop:"saleQuantity",width:"40",label:"Qty"}),o(n,{prop:"salePrice",width:"60",label:"Price"}),o(n,{prop:"saleSubtotal",width:"80",label:"Subtotal"}),o(n,{prop:"saleTax",width:"60",label:"Tax"}),o(n,{prop:"saleTotal",width:"60",label:"Total"}),o(n,{width:"40"},{default:i(h=>[o(d,{onClick:y=>l.handleRemoveItem(h),type:"danger",size:"small"},{default:i(()=>[R("X")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])}const kt=D(St,[["render",vt]]),bt={name:"CompleteSale",props:["saleItems"],emits:["compelete-sale:payment-type-selected"],data(){return{selectedPaymentType:null,testMode:!1}},computed:{activePaymentTypes(){return W().activePaymentTypes},saleItemsLength(){return this.saleItems.length},saleTotal(){let e=0;return C.each(this.saleItems,t=>{e+=Number(t.saleTotal)}),Number(e).toFixed(2)}},methods:{paymentTypeSelected(){console.log("p",this.selectedPaymentType),this.$emit("compelete-sale:payment-type-selected",this.selectedPaymentType)}}},wt={key:0},Ct=f("hr",null,null,-1),Rt={style:{display:"flex"}};function Pt(e,t,a,r,s,l){const n=c("el-option"),d=c("el-select"),u=c("el-button");return p(),S(z,null,[s.testMode?(p(),S("div",wt,[f("div",null,"sil: "+_(l.saleItemsLength),1),f("div",null,"t: "+_(l.saleTotal),1)])):k("",!0),Ct,f("div",Rt,[f("span",null,"Total: "+_(l.saleTotal),1),o(d,{style:{"margin-left":"auto"},modelValue:s.selectedPaymentType,"onUpdate:modelValue":t[0]||(t[0]=h=>s.selectedPaymentType=h)},{default:i(()=>[(p(!0),S(z,null,V(l.activePaymentTypes,h=>(p(),g(n,{value:h.id,label:h.payment_title},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]),s.selectedPaymentType?(p(),g(u,{key:0,onClick:l.paymentTypeSelected,type:"success",style:{"margin-left":"auto"}},{default:i(()=>[R("CompleteSale")]),_:1},8,["onClick"])):(p(),g(u,{key:1,disabled:"",type:"success",style:{"margin-left":"auto"}},{default:i(()=>[R("CompleteSale")]),_:1}))])],64)}const Dt=D(bt,[["render",Pt]]),Tt={name:"FolioDisplay",props:["selectedReservation","folioViewerReloadKey"],data(){return{folioDataLoaded:!1,folioData:[]}},computed:{allSaleItems(){let e=[];return C.each(this.folioData.sale_items,t=>{e.push(t)}),e},allSalePayments(){let e=[];return C.each(this.folioData.payments,t=>{e.push(t)}),e},token(){return N().token}},methods:{getFolio1(){I.folios.getFolio1(this.token,this.selectedReservation.folio).then(e=>{console.log(e.data),console.log(JSON.stringify(e.data)),this.folioData=e.data.folio_to_array,this.folioDataLoaded=!0})}},created(){console.log("folioDisplay created"),this.getFolio1()},watch:{folioViewerReloadKey(e){console.log("foliodispaly gets reload key"),this.folioData=[],this.folioDataLoaded=!1,this.getFolio1()}}},zt={key:0,class:"folio-display-wrapper"},Vt=f("div",{style:{"font-size":"1.5em"}},"Sale Items",-1),It=f("hr",null,null,-1),Mt=f("div",{style:{"font-size":"1.5em"}},"Payments",-1);function Yt(e,t,a,r,s,l){const n=c("el-table-column"),d=c("el-table");return s.folioDataLoaded?(p(),S("div",zt,[Vt,o(d,{size:"small",data:l.allSaleItems,"max-height":"250",style:{width:"100%"},"show-summary":"",stripe:""},{default:i(()=>[o(n,{prop:"sale_datetime",width:"143",label:"Date"}),o(n,{prop:"description",label:"Description"}),o(n,{prop:"sale_quantity",width:"70",label:"Qty"}),o(n,{prop:"sale_price",width:"70",label:"Price"}),o(n,{prop:"sale_subtotal",width:"70",label:"Subtotal"}),o(n,{prop:"sale_tax",width:"70",label:"Tax"}),o(n,{prop:"sale_total",width:"70",label:"Total"})]),_:1},8,["data"]),It,Mt,o(d,{size:"small",data:l.allSalePayments,"max-height":"250",style:{width:"100%"},"show-summary":"",stripe:""},{default:i(()=>[o(n,{prop:"datetime_posted",width:"143",label:"Date"}),o(n,{prop:"total",width:"70",label:"Total"}),o(n,{prop:"payment_type",width:"100",label:"Type"})]),_:1},8,["data"])])):k("",!0)}const Nt=D(Tt,[["render",Yt]]),xt={name:"SaleGroupSelect",emits:["sale-group-select:group-selected"],computed:{groupSet(){let e=[];return C.each(this.saleTypeGroups,t=>{let a={};a.groupTitle=t.title,a.groupId=t.id;let r=C.filter(this.saleTypes,s=>s.sale_type_group==t.id);a.saleTypes=r,e.push(a)}),e},saleTypeGroups(){return J().saleTypeGroups},saleTypes(){return $().saleTypes}},methods:{handleGroupClick(e){console.log("group click",JSON.parse(JSON.stringify(e))),this.$emit("sale-group-select:group-selected",e)}}};function Bt(e,t,a,r,s,l){const n=c("el-button"),d=c("el-button-group");return p(),S("div",null,[o(d,{type:"primary"},{default:i(()=>[(p(!0),S(z,null,V(l.groupSet,u=>(p(),g(n,{size:"small",onClick:h=>l.handleGroupClick(u)},{default:i(()=>[R(_(u.groupTitle),1)]),_:2},1032,["onClick"]))),256))]),_:1})])}const Ft=D(xt,[["render",Bt]]),Et={name:"SaleTypeSelect",props:["selectedGroup"],emits:["sale-type-picker:sale-type-selected"],data(){return{}},methods:{handleSelectSaleType(e){this.$emit("sale-type-picker:sale-type-selected",e)}}};function At(e,t,a,r,s,l){const n=c("el-button"),d=c("el-button-group");return p(),g(d,null,{default:i(()=>[(p(!0),S(z,null,V(a.selectedGroup.saleTypes,u=>(p(),g(n,{type:"primary",size:"small",plain:"",onClick:h=>l.handleSelectSaleType(u)},{default:i(()=>[R(_(u.title),1)]),_:2},1032,["onClick"]))),256))]),_:1})}const Lt=D(Et,[["render",At]]);const Kt={name:"FolioView",props:["folioId","selectedReservation","componentKey"],components:{ProcessSaleType:yt,SaleItems:kt,CompleteSale:Dt,FolioViewer:Nt,SaleGroupSelect:Ft,SaleTypeSelect:Lt},data(){return{folioViewerReloadKey:1,processSaleTypeResetKey:1,rootSpaces:[],saleItems:[],selectedPaymentType:null,selectedGroup:null,selectedSaleType:null}},computed:{rootSpace(){return C.find(this.rootSpaces,t=>t.id==this.selectedReservation.space_id)},saleSubtotal(){let e=0;return C.each(this.saleItems,t=>{e+=Number(t.saleSubtotal)}),e},saleTaxTotal(){let e=0;return C.each(this.saleItems,t=>{e+=Number(t.saleTax)}),e},saleTotal(){let e=0;return C.each(this.saleItems,t=>{e+=Number(t.saleTotal)}),Number(e).toFixed(2)},token(){return N().token}},methods:{addSaleItem(e){console.log("addSaleItem: ",e),e.taxTypes=Object.values(e.taxTypes),this.saleItems.push(e),this.processSaleTypeResetKey+=1,this.saleTypePickerResetKey+=1,this.selectedSaleType=null,this.selectedGroup=null},groupSelected(e){console.log("setting i",JSON.parse(JSON.stringify(e))),this.selectedGroup=JSON.parse(JSON.stringify(e)),this.selectedSaleType=null},handlePaymentTypeSelected(e){if(this.selectedPaymentType=e,this.saleItems&&this.saleItems.length>0){console.log("here"),this.selectedReservation.id,this.selectedReservation.customer,this.selectedReservation.folioId;const t={resId:this.selectedReservation.id,resCustomer:this.selectedReservation.customer,resFolio:this.selectedReservation.folio,saleItems:this.saleItems,paymentType:e,saleTotal:this.saleTotal,saleSubtotal:this.saleSubtotal,saleTax:this.saleTaxTotal,soldBy:N().account.id};console.log(t),console.log(JSON.stringify(t)),I.payments.postQuickFolioSale(t,this.token).then(a=>{console.log("quick sale",a.data),a.data.sale_items_posted&&a.data.payment_posted&&(x({type:"success",message:"Transaction completed"}),this.resetSale(),this.folioViewerReloadKey+=1)})}},removeItemAtIndex(e){console.log("rAI",e),this.saleItems.splice(e,1),this.selectedGroup=null},resetSale(){this.selectedGroup=null,this.selectedSaleType=null,this.saleItems=[]},saleTypeSelected(e){e=JSON.parse(JSON.stringify(e)),this.selectedSaleType=e,console.log(e)}},mounted(){T().showHideRootSpaceCopy?this.rootSpaces=T().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces},watch:{folioId(e){this.selectedSaleType=null}}},$t=f("span",null," : ",-1),Ut={key:0},qt=f("hr",null,null,-1),Qt=f("hr",null,null,-1);function Ot(e,t,a,r,s,l){const n=c("el-button"),d=c("SaleGroupSelect"),u=c("SaleTypeSelect"),h=c("ProcessSaleType"),y=c("SaleItems"),m=c("CompleteSale"),b=c("el-col"),w=c("FolioViewer"),M=c("el-row");return p(),S("div",null,[o(M,null,{default:i(()=>[o(b,{span:12},{default:i(()=>[f("div",null,_(a.selectedReservation.customer_first)+"\xA0"+_(this.selectedReservation.customer_last),1),f("div",null,[f("span",null,_(a.selectedReservation.checkin),1),$t,f("span",null,_(a.selectedReservation.checkout),1)]),l.rootSpace?(p(),S("div",Ut,_(e.$t("message.spaceLabel"))+": "+_(l.rootSpace.title),1)):k("",!0),f("div",null,_(e.$t("message.people"))+": "+_(a.selectedReservation.people),1),f("div",null,_(e.$t("message.beds"))+": "+_(a.selectedReservation.beds),1),qt,o(n,{type:"danger",size:"small",onClick:l.resetSale},{default:i(()=>[R("Reset Sale")]),_:1},8,["onClick"]),o(d,{"onSaleGroupSelect:groupSelected":l.groupSelected},null,8,["onSaleGroupSelect:groupSelected"]),s.selectedGroup?(p(),g(u,{key:1,selectedGroup:s.selectedGroup,"onSaleTypePicker:saleTypeSelected":l.saleTypeSelected},null,8,["selectedGroup","onSaleTypePicker:saleTypeSelected"])):k("",!0),Qt,o(h,{saleType:s.selectedSaleType,processSaleTypeResetKey:s.processSaleTypeResetKey,"onProcessSaleType:addSaleItem":l.addSaleItem},null,8,["saleType","processSaleTypeResetKey","onProcessSaleType:addSaleItem"]),s.saleItems.length>0?(p(),g(y,{key:2,saleItems:s.saleItems,"onSaleItems:removeAtIndex":l.removeItemAtIndex},null,8,["saleItems","onSaleItems:removeAtIndex"])):k("",!0),s.saleItems.length>0?(p(),g(m,{key:3,saleItems:s.saleItems,"onCompeleteSale:paymentTypeSelected":l.handlePaymentTypeSelected},null,8,["saleItems","onCompeleteSale:paymentTypeSelected"])):k("",!0)]),_:1}),o(b,{span:12},{default:i(()=>[o(w,{folioViewerReloadKey:s.folioViewerReloadKey,selectedReservation:a.selectedReservation},null,8,["folioViewerReloadKey","selectedReservation"])]),_:1})]),_:1})])}const Ht=D(Kt,[["render",Ot]]),Gt={setup(){const{handleRequestError:e}=A();return{handleRequestError:e}},name:"ReservationView",props:["selectedReservation"],components:{EditReservation:ht,FolioView:Ht},emits:["reservation-view:close-view","reservation-view:update-reservations","reservation-view:update-selected-reservation"],data(){return{componentKey:1,rootSpaces:null,showHistory:!1,showFolioDialog:!1}},computed:{token(){return N().token},rootSpace(){return C.find(this.rootSpaces,t=>t.id==this.selectedReservation.space_id)}},methods:{closeReservationView(){this.$emit("reservation-view:close-view")},modifyReservation1(e){I.reservations.modifyReservation1(e,this.token).then(t=>{console.log("modifyReservation1:"),console.log(t.data),t.data.success==!0?(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",t.data.current_res),this.componentKey+=1,x({type:"success",message:"Reservation updated"})):x({type:"warning",message:"There was an error"})}).catch(t=>{this.handleRequestError(t)})},reservationCheckin(){I.reservations.reservationCheckin(this.selectedReservation.id,this.token).then(e=>{e.data.checkin==!0&&e.data.reservation_after_checkin?(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",e.data.reservation_after_checkin),x({type:"success",message:"Reservation checked in"})):x({type:"warning",message:"There was an error"})}).catch(e=>{this.handleRequestError(e)})},reservationCheckout(){I.reservations.reservationCheckout(this.selectedReservation.id,this.token).then(e=>{console.log(e),e.data.checkout==!0&&e.data.reservation_after_checkout&&(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",e.data.reservation_after_checkout),x({type:"success",message:"Reservatin checked out"}))}).catch(e=>{this.handleRequestError(e)})}},mounted(){T().showHideRootSpaceCopy?this.rootSpaces=T().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces}};const jt={key:0,class:"wrapper"},Wt=f("br",null,null,-1),Jt=f("span",null," : ",-1),Xt={key:0},Zt={key:0},es={key:1},ts={class:"historyTable"};function ss(e,t){const a=c("FolioView"),r=c("el-dialog"),s=c("font-awesome-icon"),l=c("el-button"),n=c("EditReservation"),d=c("el-collapse-item"),u=c("el-collapse");return p(),S(z,null,[o(r,{modelValue:e.showFolioDialog,"onUpdate:modelValue":t[0]||(t[0]=h=>e.showFolioDialog=h),fullscreen:!0,"destroy-on-close":!0},{default:i(()=>[o(a,{folioId:e.selectedReservation.folio,selectedReservation:e.selectedReservation,componentKey:e.componentKey},null,8,["folioId","selectedReservation","componentKey"])]),_:1},8,["modelValue"]),e.rootSpaces?(p(),S("div",jt,[f("div",null,[o(s,{onClick:e.closeReservationView,color:"#f56c6c",icon:"fa-window-close",size:"xl",style:{float:"right"}},null,8,["onClick"])]),Wt,f("div",null,_(e.selectedReservation.customer_first)+"\xA0"+_(this.selectedReservation.customer_last),1),f("div",null,[f("span",null,_(e.selectedReservation.checkin),1),Jt,f("span",null,_(e.selectedReservation.checkout),1)]),e.rootSpace?(p(),S("div",Xt,_(e.$t("message.spaceLabel"))+": "+_(e.rootSpace.title),1)):k("",!0),f("div",null,_(e.$t("message.people"))+": "+_(e.selectedReservation.people),1),f("div",null,_(e.$t("message.beds"))+": "+_(e.selectedReservation.beds),1),f("div",null,"Res Id : "+_(e.selectedReservation.id),1),f("div",null,[e.selectedReservation.status==0?(p(),S("span",Zt,[o(l,{type:"success",onClick:e.reservationCheckin},{default:i(()=>[R(_(e.$t("message.checkin")),1)]),_:1},8,["onClick"])])):k("",!0),e.selectedReservation.status==1?(p(),S("span",es,[o(l,{type:"info",onClick:e.reservationCheckout},{default:i(()=>[R(_(e.$t("message.checkout")),1)]),_:1},8,["onClick"])])):k("",!0),f("span",null,[o(l,{onClick:t[1]||(t[1]=h=>e.showFolioDialog=!0),type:"primary"},{default:i(()=>[R("Folio")]),_:1})])]),o(u,null,{default:i(()=>[o(d,{title:"Edit Reservation",name:"2"},{default:i(()=>[e.rootSpaces?(p(),g(n,{key:0,componentKey:e.componentKey,resId:e.selectedReservation.id,checkin:e.selectedReservation.checkin,checkout:e.selectedReservation.checkout,people:e.selectedReservation.people,beds:e.selectedReservation.beds,isAssigned:e.selectedReservation.is_assigned,spaceTypePref:e.selectedReservation.space_type_pref,spaceId:e.selectedReservation.space_id,customer:e.selectedReservation.customer,customerFirst:e.selectedReservation.first_name,customerLast:e.selectedReservation.last_name,"onEditReservation:modifyReservation1":e.modifyReservation1},null,8,["componentKey","resId","checkin","checkout","people","beds","isAssigned","spaceTypePref","spaceId","customer","customerFirst","customerLast","onEditReservation:modifyReservation1"])):k("",!0)]),_:1}),o(d,{title:"History",name:"1"},{default:i(()=>[f("table",ts,[f("tbody",null,[(p(!0),S(z,null,V(e.selectedReservation.history,h=>(p(),S("tr",null,[f("td",null,_(h.text),1),f("td",null,_(h.account_name),1),f("td",null,_(h.date),1)]))),256))])])]),_:1})]),_:1})])):k("",!0)],64)}const ls=D(Gt,[["render",ss]]);var as={exports:{}};(function(e,t){(function(a,r){e.exports=r(X.exports)})(Z,function(a){function r(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var s=r(a),l={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},ordinal:function(n){return n+"\xBA"}};return s.default.locale(l,null,!0),l})})(as);const os={name:"splitpanes",emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((e,t)=>(e[t.id]=t)&&e,{})}},methods:{updatePaneComponents(){this.panes.forEach(e=>{e.update&&e.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[e.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(e,t){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=t},onMouseMove(e){this.touch.mouseDown&&(e.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(e)),this.$emit("resize",this.panes.map(t=>({min:t.min,max:t.max,size:t.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(e,t){"ontouchstart"in window&&(e.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===t?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(e,t),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=t,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[t])},onSplitterDblClick(e,t){let a=0;this.panes=this.panes.map((r,s)=>(r.size=s===t?r.max:r.min,s!==t&&(a+=r.min),r)),this.panes[t].size-=a,this.$emit("pane-maximize",this.panes[t]),this.$emit("resized",this.panes.map(r=>({min:r.min,max:r.max,size:r.size})))},onPaneClick(e,t){this.$emit("pane-click",this.indexedPanes[t])},getCurrentMouseDrag(e){const t=this.container.getBoundingClientRect(),{clientX:a,clientY:r}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:a-t.left,y:r-t.top}},getCurrentDragPercentage(e){e=e[this.horizontal?"y":"x"];const t=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(e=t-e),e*100/t},calculatePanesSize(e){const t=this.touch.activeSplitter;let a={prevPanesSize:this.sumPrevPanesSize(t),nextPanesSize:this.sumNextPanesSize(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const r=0+(this.pushOtherPanes?0:a.prevPanesSize),s=100-(this.pushOtherPanes?0:a.nextPanesSize),l=Math.max(Math.min(this.getCurrentDragPercentage(e),s),r);let n=[t,t+1],d=this.panes[n[0]]||null,u=this.panes[n[1]]||null;const h=d.max<100&&l>=d.max+a.prevPanesSize,y=u.max<100&&l<=100-(u.max+this.sumNextPanesSize(t+1));if(h||y){h?(d.size=d.max,u.size=Math.max(100-d.max-a.prevPanesSize-a.nextPanesSize,0)):(d.size=Math.max(100-u.max-a.prevPanesSize-this.sumNextPanesSize(t+1),0),u.size=u.max);return}if(this.pushOtherPanes){const m=this.doPushOtherPanes(a,l);if(!m)return;({sums:a,panesToResize:n}=m),d=this.panes[n[0]]||null,u=this.panes[n[1]]||null}d!==null&&(d.size=Math.min(Math.max(l-a.prevPanesSize-a.prevReachedMinPanes,d.min),d.max)),u!==null&&(u.size=Math.min(Math.max(100-l-a.nextPanesSize-a.nextReachedMinPanes,u.min),u.max))},doPushOtherPanes(e,t){const a=this.touch.activeSplitter,r=[a,a+1];return t<e.prevPanesSize+this.panes[r[0]].min&&(r[0]=this.findPrevExpandedPane(a).index,e.prevReachedMinPanes=0,r[0]<a&&this.panes.forEach((s,l)=>{l>r[0]&&l<=a&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),e.prevPanesSize=this.sumPrevPanesSize(r[0]),r[0]===void 0)?(e.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((s,l)=>{l>0&&l<=a&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),this.panes[r[1]].size=100-e.prevReachedMinPanes-this.panes[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-this.panes[r[1]].min&&(r[1]=this.findNextExpandedPane(a).index,e.nextReachedMinPanes=0,r[1]>a+1&&this.panes.forEach((s,l)=>{l>a&&l<r[1]&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),e.nextPanesSize=this.sumNextPanesSize(r[1]-1),r[1]===void 0)?(e.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((s,l)=>{l<this.panesCount-1&&l>=a+1&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),this.panes[r[0]].size=100-e.prevPanesSize-e.nextReachedMinPanes-this.panes[this.panesCount-1].min-e.nextPanesSize,null):{sums:e,panesToResize:r}},sumPrevPanesSize(e){return this.panes.reduce((t,a,r)=>t+(r<e?a.size:0),0)},sumNextPanesSize(e){return this.panes.reduce((t,a,r)=>t+(r>e+1?a.size:0),0)},findPrevExpandedPane(e){return[...this.panes].reverse().find(t=>t.index<e&&t.size>t.min)||{}},findNextExpandedPane(e){return this.panes.find(t=>t.index>e+1&&t.size>t.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(e=>{const t=e.classList.contains("splitpanes__pane"),a=e.classList.contains("splitpanes__splitter");!t&&!a&&(e.parentNode.removeChild(e),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},addSplitter(e,t,a=!1){const r=e-1,s=document.createElement("div");s.classList.add("splitpanes__splitter"),a||(s.onmousedown=l=>this.onMouseDown(l,r),typeof window<"u"&&"ontouchstart"in window&&(s.ontouchstart=l=>this.onMouseDown(l,r)),s.onclick=l=>this.onSplitterClick(l,r+1)),this.dblClickSplitter&&(s.ondblclick=l=>this.onSplitterDblClick(l,r+1)),t.parentNode.insertBefore(s,t)},removeSplitter(e){e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.parentNode.removeChild(e)},redoSplitters(){const e=Array.from(this.container.children);e.forEach(a=>{a.className.includes("splitpanes__splitter")&&this.removeSplitter(a)});let t=0;e.forEach(a=>{a.className.includes("splitpanes__pane")&&(!t&&this.firstSplitter?this.addSplitter(t,a,!0):t&&this.addSplitter(t,a),t++)})},requestUpdate({target:e,...t}){const a=this.indexedPanes[e._.uid];Object.entries(t).forEach(([r,s])=>a[r]=s)},onPaneAdd(e){let t=-1;Array.from(e.$el.parentNode.children).some(s=>(s.className.includes("splitpanes__pane")&&t++,s===e.$el));const a=parseFloat(e.minSize),r=parseFloat(e.maxSize);this.panes.splice(t,0,{id:e._.uid,index:t,min:isNaN(a)?0:a,max:isNaN(r)?100:r,size:e.size===null?null:parseFloat(e.size),givenSize:e.size,update:e.update}),this.panes.forEach((s,l)=>s.index=l),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[t]}),this.$emit("pane-add",{index:t,panes:this.panes.map(s=>({min:s.min,max:s.max,size:s.size}))})})},onPaneRemove(e){const t=this.panes.findIndex(r=>r.id===e._.uid),a=this.panes.splice(t,1)[0];this.panes.forEach((r,s)=>r.index=s),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:{...a,index:t}}),this.$emit("pane-remove",{removed:a,panes:this.panes.map(r=>({min:r.min,max:r.max,size:r.size}))})})},resetPaneSizes(e={}){!e.addedPane&&!e.removedPane?this.initialPanesSizing():this.panes.some(t=>t.givenSize!==null||t.min||t.max<100)?this.equalizeAfterAddOrRemove(e):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(t=>({min:t.min,max:t.max,size:t.size})))},equalize(){const e=100/this.panesCount;let t=0;const a=[],r=[];this.panes.forEach(s=>{s.size=Math.max(Math.min(e,s.max),s.min),t-=s.size,s.size>=s.max&&a.push(s.id),s.size<=s.min&&r.push(s.id)}),t>.1&&this.readjustSizes(t,a,r)},initialPanesSizing(){let e=100;const t=[],a=[];let r=0;this.panes.forEach(l=>{e-=l.size,l.size!==null&&r++,l.size>=l.max&&t.push(l.id),l.size<=l.min&&a.push(l.id)});let s=100;e>.1&&(this.panes.forEach(l=>{l.size===null&&(l.size=Math.max(Math.min(e/(this.panesCount-r),l.max),l.min)),s-=l.size}),s>.1&&this.readjustSizes(e,t,a))},equalizeAfterAddOrRemove({addedPane:e,removedPane:t}={}){let a=100/this.panesCount,r=0;const s=[],l=[];e&&e.givenSize!==null&&(a=(100-e.givenSize)/(this.panesCount-1)),this.panes.forEach(n=>{r-=n.size,n.size>=n.max&&s.push(n.id),n.size<=n.min&&l.push(n.id)}),!(Math.abs(r)<.1)&&(this.panes.forEach(n=>{e&&e.givenSize!==null&&e.id===n.id||(n.size=Math.max(Math.min(a,n.max),n.min)),r-=n.size,n.size>=n.max&&s.push(n.id),n.size<=n.min&&l.push(n.id)}),r>.1&&this.readjustSizes(r,s,l))},readjustSizes(e,t,a){let r;e>0?r=e/(this.panesCount-t.length):r=e/(this.panesCount-a.length),this.panes.forEach((s,l)=>{if(e>0&&!t.includes(s.id)){const n=Math.max(Math.min(s.size+r,s.max),s.min),d=n-s.size;e-=d,s.size=n}else if(!a.includes(s.id)){const n=Math.max(Math.min(s.size+r,s.max),s.min),d=n-s.size;e-=d,s.size=n}s.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[s.id].size}%`})}),Math.abs(e)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(e){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((t,a)=>{t.ondblclick=e?r=>this.onSplitterDblClick(r,a):void 0})}},beforeUnmount(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(){return ee("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default())}},ns=(e,t)=>{const a=e.__vccOpts||e;for(const[r,s]of t)a[r]=s;return a},is={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeUnmount(){this.onPaneRemove(this)},methods:{update(e){this.style=e}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(e){this.requestUpdate({target:this,size:e})},minSizeNumber(e){this.requestUpdate({target:this,min:e})},maxSizeNumber(e){this.requestUpdate({target:this,max:e})}}};function rs(e,t,a,r,s,l){return p(),S("div",{class:"splitpanes__pane",onClick:t[0]||(t[0]=n=>l.onPaneClick(n,e._.uid)),style:se(e.style)},[te(e.$slots,"default")],4)}const cs=ns(is,[["render",rs]]);const ds={setup(){const{handleRequestError:e}=A();return{handleRequestError:e}},name:"resView3",components:{singleDatePicker:oe,ResViewTable:Ke,CreateReservation:dt,ReservationView:ls,Splitpanes:os,Pane:cs},data(){return{leftPaneSize:30,overRideSingleDatePicker:"",reservationDialog:!1,reservations:[],rootSpaces:null,selectedReservation:null,showCreateReservation:!0,showReservationView:!1,trigger:1,windowHeight:0,windowWidth:0,componentTrigger:0}},computed:{locale(){return B().selectedLocale},token(){return N().token},rDrawerWidth(){if(this.windowWidth<768)return"100%";if(this.windowWidth>768&&this.windowWidth<1200)return"500px";if(this.windowWidth>=1200)return"35%"},resViewEndDate(){return v(this.resViewStartDate).add(31,"days").format("YYYY-MM-DD")},resViewStartDate(){return T().startDate},resTableData(){let e,t,a,r,s,l,n;return C.each(this.rootSpaces,d=>{const u=Object.keys(d);C.each(u,h=>{h.substring(0,1)=="D"&&delete d[h]})}),n=this.rootSpaces,C.each(this.reservations,d=>{if(d.checkout!=this.resViewStartDate){let u=C.find(n,h=>h.id==d.space_id);if(u){v(d.checkout).isAfter(v(this.resViewEndDate))?r=!1:r=!0,v(d.checkin).isBefore(v(this.resViewStartDate))?(a=!1,e=v(this.resViewStartDate).format("YYYYMMDD"),t=v(this.resViewStartDate).format("YYYY-MM-DD"),v(d.checkout).diff(v(this.resViewStartDate),"d")):(a=!0,e=v(d.checkin).format("YYYYMMDD"),t=v(d.checkin).format("YYYY-MM-DD"),v(d.checkout).diff(v(d.checkin),"d"));let h=v(d.checkout).diff(v(t),"d");for(let y=0;y<h;y++){let m=v(e).add(y,"d").format("YYYYMMDD");y==0&&(s="D"+m+"isfirst",u[s]=!0),v(this.resViewEndDate).isSame(m)&&(s="D"+m+"islast",u[s]=!0),s="D"+m+"blocked",u[s]=!1,s="D"+m+"starttruncated",u[s]=!a,s="D"+m+"endtruncated",u[s]=!r,s="D"+m+"resid",u[s]=d.id,s="D"+m+"start",u[s]=d.checkin,s="D"+m+"end",u[s]=d.checkout,s="D"+m+"customer",u[s]=d.customer_last,s="D"+m+"status",u[s]=d.status}}if(u&&u.children.length>0&&C.forEach(u.children,h=>{let y=C.find(n,m=>m.id==h);if(y){let m=v(d.checkout).diff(v(t),"d");for(let b=0;b<m;b++){let w=v(e).add(b,"d").format("YYYYMMDD");if(l="D"+w+"blocked",!y[l]){let M="D"+w+"blocked";y[M]=!0,M="D"+w+"span",y[M]=1,M="D"+w+"resIdRef",y[M]=d.id}}}}),u&&u.parents.length>0&&C.forEach(u.parents,h=>{let y=C.find(n,m=>m.id==h);if(y){let m=v(d.checkout).diff(v(t),"d");for(let b=0;b<m;b++){let w=v(e).add(b,"d").format("YYYYMMDD"),M="D"+w+"blocked";if(!y[M]){let P="D"+w+"blocked";y[P]=!0,P="D"+w+"span",y[P]=1,P="D"+w+"resIdRef",y[P]=d.id}}}}),d.is_assigned==0){console.log("iReservation @ handle unassigned"),console.table(d);let y="D"+v(d.checkin).format("YYYYMMDD")+"unassigned",m=C.find(n,b=>b.isUnassigned==1);m&&(m[y]?m[y].push(d):m[y]=[{...d}])}}}),n},tableHeight(){return this.windowHeight-110},tDateArray(){v.locale(this.locale.name);const e=[];for(let t=0;t<32;t++){let a={dayString:"D"+v(this.resViewStartDate).add(t,"day").format("YYYYMMDD"),dayLabel:v(this.resViewStartDate).add(t,"day").format("ddd MMM D")};e.push(a)}return e}},methods:{childrenHide(e){e.showChildren=0,C.each(e.children,t=>{console.log("childId",t);let a=C.find(this.rootSpaces,r=>r.id==t);console.log("m",a),a&&this.childrenHide(a)})},childrenShow(e){e.showChildren=1,C.each(e.children,t=>{C.find(this.rootSpaces,a=>a.id==t)})},clearReservations(){},closeReservationView(){this.showCreateReservation=!0,this.showReservationView=!1},emptyCellClick(e){console.log("empty cell selected",e)},getReservations(){I.reservations.getReservationsByRange(this.resViewStartDate,this.resViewEndDate,this.token).then(e=>{console.log("res fetch from rv3 getR()"),this.reservations=e.data.reservations,this.componentTrigger+=1}).catch(e=>{this.handleRequestError(e),this.reservations=[]})},leftPane100(){this.leftPaneSize=100},leftPane30(){this.leftPaneSize=30},leftPane50(){this.leftPaneSize=50},leftPane70(){this.leftPaneSize=70},leftPane10(){this.leftPaneSize=5},leftResize(e){console.log(e)},reservationSelected(e){const t=C.find(this.reservations,function(a){return a.id==e});this.selectedReservation={...t},this.showCreateReservation=!1,this.showReservationView=!0},rowClassName(e){},showCreateReservationFtn(){this.showCreateReservation=!0,this.showReservationView=!1},singleDateSelected(e){let t=v(e).format("YYYY-MM-DD");T().startDate=t,this.getReservations()},toggleShowChildren(e){let t=C.find(this.rootSpaces,a=>a.id==e);t.showChildren?this.childrenHide(t):this.childrenShow(t),T().setShowHideRootSpaceCopy(this.rootSpaces)},toggleCreateReservationDrawer(){this.showCreateReservationDrawer=!this.showCreateReservationDrawer},unassignedResSelected(e){const t=C.find(this.reservations,function(a){return a.id==e});this.selectedReservation={...t},this.showCreateReservation=!1,this.showReservationView=!0},updateSelectedReservation(e){this.selectedReservation=e},viewBack1(){const e=v(T().startDate).subtract(1,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewBack7(){const e=v(T().startDate).subtract(7,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewForward1(){const e=v(T().startDate).add(1,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewForward7(){const e=v(T().startDate).add(7,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e}},created(){v.extend(v),v.extend(v),this.spaceRecords={}},mounted(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,window.addEventListener("resize",e=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight},!0),T().showHideRootSpaceCopy?this.rootSpaces=T().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces,this.getReservations()}},us={style:{display:"flex","flex-direction":"row-reverse"}},ps={style:{"margin-left":"4px"}};function ms(e,t,a,r,s,l){const n=c("el-button"),d=c("el-button-group"),u=c("CreateReservation"),h=c("ReservationView"),y=c("pane"),m=c("singleDatePicker"),b=c("ResViewTable"),w=c("splitpanes");return p(),g(w,{onResized:l.leftResize},{default:i(()=>[o(y,{size:s.leftPaneSize},{default:i(()=>[f("div",us,[o(d,null,{default:i(()=>[o(n,{type:"warning",onClick:l.leftPane10},{default:i(()=>[R("<<")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane30},{default:i(()=>[R("<")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane50},{default:i(()=>[R("|")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane70},{default:i(()=>[R(">")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane100},{default:i(()=>[R(">>")]),_:1},8,["onClick"])]),_:1})]),s.showCreateReservation?(p(),g(u,{key:0,"onCreateReservation:reloadReservations":l.getReservations},null,8,["onCreateReservation:reloadReservations"])):k("",!0),s.showReservationView?(p(),g(h,{key:1,selectedReservation:s.selectedReservation,"onReservationView:closeView":l.closeReservationView,"onReservationView:updateReservations":l.getReservations,"onReservationView:updateSelectedReservation":l.updateSelectedReservation},null,8,["selectedReservation","onReservationView:closeView","onReservationView:updateReservations","onReservationView:updateSelectedReservation"])):k("",!0)]),_:1},8,["size"]),o(y,{size:100-s.leftPaneSize},{default:i(()=>[f("div",ps,[f("span",null,[o(d,null,{default:i(()=>[o(n,{type:"warning",onClick:l.viewBack7},{default:i(()=>[R("-7")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.viewBack1},{default:i(()=>[R("-1")]),_:1},8,["onClick"])]),_:1}),o(m,{overrideDate:s.overRideSingleDatePicker,"onSingleDatePicker:dateSelected":l.singleDateSelected},null,8,["overrideDate","onSingleDatePicker:dateSelected"]),o(d,null,{default:i(()=>[o(n,{type:"warning",onClick:l.viewForward1},{default:i(()=>[R("+1")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.viewForward7},{default:i(()=>[R("+7")]),_:1},8,["onClick"])]),_:1}),R("\xA0 "),o(n,{type:"success",onClick:l.showCreateReservationFtn},{default:i(()=>[R(_(e.$t("message.createReservation")),1)]),_:1},8,["onClick"])]),s.rootSpaces?(p(),g(b,{key:0,onResBlockClick:l.reservationSelected,onResviewToggleShowChildren:l.toggleShowChildren,onEmptyCellClick:l.emptyCellClick,onUnassignedResSelected:l.unassignedResSelected,tDateArray:l.tDateArray,tableData:l.resTableData,trigger:s.trigger,resSpaceCopy:e.spaceRecords,tableHeight:l.tableHeight},null,8,["onResBlockClick","onResviewToggleShowChildren","onEmptyCellClick","onUnassignedResSelected","tDateArray","tableData","trigger","resSpaceCopy","tableHeight"])):k("",!0)])]),_:1},8,["size"])]),_:1},8,["onResized"])}const fs=D(ds,[["render",ms]]);export{fs as default};
