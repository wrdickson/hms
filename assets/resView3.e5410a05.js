import{_ as D,r as z,l as F,o as u,c as y,w as c,a as o,b as d,d as k,n as K,e as v,t as f,F as T,p as Q,f as O,g as p,i as g,h as b,j as I,E as N,k as Y,m as x,q as M,s as w,S as G,u as H,v as E,x as A,y as j,z as $,A as W,B as J,C as X,D as Z,G as ee,H as te}from"./index.d27f8517.js";const se={name:"singelDatePicker",props:["overrideDate"],emits:["singleDatePicker:dateSelected"],data(){return{selectedDate:z().startDate,size:"default"}},computed:{datepickerPlaceholder(){return this.$t("message.datepickerPlaceholder")},locale(){return F().selectedLocale}},watch:{overrideDate(e){this.selectedDate=e},selectedDate(e,t){this.$emit("singleDatePicker:dateSelected",this.selectedDate)}}};function le(e,t,a,i,s,l){const n=d("el-date-picker"),r=d("el-config-provider");return u(),y(r,{locale:l.locale},{default:c(()=>[o(n,{modelValue:s.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=m=>s.selectedDate=m),type:"date",format:"D-MMM-YYYY",placeholder:l.datepickerPlaceholder,size:s.size},null,8,["modelValue","placeholder","size"])]),_:1},8,["locale"])}const ae=D(se,[["render",le]]);const oe={props:["isFirst","isLast","resId","start","end","name","span","startTruncated","endTruncated","status"],name:"resBlock",emits:["resBlockClick"],data(){return{}},computed:{classGenerate(){return"resblock-"+this.resId},shortName(){return this.name.length>7?this.name.substring(0,7)+"...":this.name}},methods:{resClicked(e){this.$emit("resBlockClick",e)}}},B=e=>(Q("data-v-f87405b0"),e=e(),O(),e),ne={key:0},re=B(()=>p("b",null,"<",-1)),ie=[re],ce={key:1},de={key:2,class:"float-right"},ue=B(()=>p("b",null,">",-1)),me=[ue],he=B(()=>p("span",{class:"sameAsCheckoutBackground"},".",-1)),pe={key:0},fe=B(()=>p("b",null,"<",-1)),_e=[fe],ye={key:1},Se={key:2,class:"float-right"},ge=B(()=>p("b",null,">",-1)),ve=[ge],ke=B(()=>p("span",{class:"sameAsCheckinBackground"},".",-1));function Ce(e,t,a,i,s,l){return u(),k(T,null,[a.status==0?(u(),k("div",{key:0,class:K([l.classGenerate,"resBlockCheckedOut res-block"]),onClick:t[0]||(t[0]=n=>l.resClicked(a.resId))},[a.startTruncated&&a.isFirst?(u(),k("span",ne,ie)):v("",!0),a.isFirst?(u(),k("span",ce,f(l.shortName),1)):v("",!0),a.endTruncated&&a.isLast?(u(),k("span",de,me)):v("",!0),he],2)):v("",!0),a.status==1?(u(),k("div",{key:1,class:K([l.classGenerate,"resBlockCheckedIn res-block"]),onClick:t[1]||(t[1]=n=>l.resClicked(a.resId))},[a.startTruncated&&a.isFirst?(u(),k("span",pe,_e)):v("",!0),a.isFirst?(u(),k("span",ye,f(l.shortName),1)):v("",!0),a.endTruncated&&a.isLast?(u(),k("span",Se,ve)):v("",!0),ke],2)):v("",!0)],64)}const we=D(oe,[["render",Ce],["__scopeId","data-v-f87405b0"]]);const be={props:["resIdRef","start","end","span","startTruncated","blockIndicator"],name:"emptyBlock",emits:["empty-block-click"],methods:{emptyBlockClick(){console.log("emptyBlockClick @emptyBlock"),this.$emit("empty-block-click")}}};function Re(e,t,a,i,s,l){return u(),k("div",{onClick:t[0]||(t[0]=(...n)=>l.emptyBlockClick&&l.emptyBlockClick(...n)),class:"emptyBlock"},[p("span",null,"blocked"+f(a.resIdRef),1)])}const Pe=D(be,[["render",Re]]);const De={name:"c1",props:["spaceId","showChildren","children"],emits:["c1-toggle-show-children"],computed:{hasChildren(){return this.children.length>0}},methods:{divClick(e){return console.log("divClick",this.spaceId),this.$emit("c1-toggle-show-children",this.spaceId),!1}}},ze={key:0};function Te(e,t,a,i,s,l){const n=d("font-awesome-icon"),r=d("el-button");return u(),k("div",{onClick:t[0]||(t[0]=(...m)=>l.divClick&&l.divClick(...m)),class:"c1-wrapper"},[l.hasChildren?(u(),k("div",ze,[a.showChildren==0?(u(),y(r,{key:0,class:"eButton",type:"primary",plain:"",size:"small"},{default:c(()=>[o(n,{icon:"fa-chevron-right",size:"sm"})]),_:1})):v("",!0),a.showChildren==1?(u(),y(r,{key:1,class:"eButton",type:"primary",plain:"",size:"small"},{default:c(()=>[o(n,{icon:"fa-chevron-down",size:"sm"})]),_:1})):v("",!0)])):v("",!0)])}const xe=D(De,[["render",Te],["__scopeId","data-v-b56fffa7"]]),Ve={name:"ResViewTable",components:{c1:xe,resBlock:we,emptyBlock:Pe},emits:["resview-toggle-show-children","resBlockClick","emptyBlockClick","emptyCellClick"],props:["tDateArray","tableData","trigger","resSpaceCopy","tableHeight"],data(){return{}},computed:{spaceLabel(){return this.$t("message.spaceLabel")}},methods:{setInitialScroll(){z().scrollTop>0&&this.setScrollTop(z().scrollTop),z().scrollLeft>0&&this.setScrollLeft(z().scrollLeft)},setScrollLeft(e){this.$refs.resViewTable.$refs.scrollBarRef.setScrollLeft(e)},setScrollTop(e){this.$refs.resViewTable.$refs.scrollBarRef.setScrollTop(e)},c1ToggleShowChildren(e){console.log("resViewTable toggle",e),this.$emit("resview-toggle-show-children",e)},cellClick(e,t){let i=t.property+"resid";if(!e[i]){let s={spaceId:e.id,selectedDate:g(t.property.substr(1)).format("YYYY-MM-DD")};t.property!="description"&&t.property!="expand"&&this.$emit("emptyCellClick",s)}},emptyBlockClick(e,t){console.log("emptyBlockClick on resViewTable",e,t)},getChildrenIds(e){const t=[],a=i=>{let s=b.find(this.resSpaceCopy,l=>l.childOf==i);if(s)b.each(s,l=>{console.log("child",l.id),t.push(l.id),a(l.id)});else return console.log("cArr",t),t};a(e)},resBlockClick(e){this.$emit("resBlockClick",e)},rowStyle(e){if(e.row.childOf>0)return b.find(this.tableData,a=>a.id==e.row.childOf).showChildren==!0?"":"display: none;"}},mounted(){setTimeout(this.setInitialScroll,1),this.$refs.resViewTable.$refs.scrollBarRef.wrapRef.onscroll=e=>{z().scrollLeft=e.target.scrollLeft,z().scrollTop=e.target.scrollTop}},watch:{resSpaceCopy(e,t){console.log("resSpaceCopy change on resViewTable")},tableData(){console.log("tableData wach triggered on resViewTable")},trigger(){console.log("trigger watch on resViewTable",this.trigger)}}};const Ie={"data-rel-day":"0",style:{display:"flex","align-items":"center"}},Me={style:{display:"flex","align-items":"center"}};function Ye(e,t){const a=d("el-table-column"),i=d("c1"),s=d("resBlock"),l=d("emptyBlock"),n=d("el-table");return u(),y(n,{ref:"resViewTable",data:e.tableData,"row-style":e.rowStyle,height:e.tableHeight,"row-class-name":"resview-row","cell-class-name":"resview-table-cell","header-cell-class-name":"resview-header-cell","header-row-class-name":"resview-header-row",style:{width:"100%",padding:"0px"},onCellClick:e.cellClick,onEmptyBlockClick:e.emptyBlockClick},{default:c(()=>[o(a,{fixed:"",prop:"title",label:e.spaceLabel,width:"120"},null,8,["label"]),o(a,{prop:"expand",fixed:"",width:"27"},{default:c(r=>[p("div",Ie,[o(i,{spaceId:r.row.id,showChildren:r.row.showChildren,children:r.row.children,onC1ToggleShowChildren:e.c1ToggleShowChildren},null,8,["spaceId","showChildren","children","onC1ToggleShowChildren"])])]),_:1}),(u(!0),k(T,null,I(e.tDateArray,r=>(u(),y(a,{prop:r.dayString,label:r.dayLabel,width:"90"},{default:c(m=>[p("div",Me,[m.row[r.dayString+"resid"]?(u(),y(s,{key:0,onResBlockClick:e.resBlockClick,resId:m.row[r.dayString+"resid"],start:m.row[r.dayString+"start"],end:m.row[r.dayString+"end"],name:m.row[r.dayString+"customer"],span:m.row[r.dayString+"span"],startTruncated:m.row[r.dayString+"starttruncated"],endTruncated:m.row[r.dayString+"endtruncated"],isFirst:m.row[r.dayString+"isfirst"],isLast:m.row[r.dayString+"islast"],status:m.row[r.dayString+"status"]},null,8,["onResBlockClick","resId","start","end","name","span","startTruncated","endTruncated","isFirst","isLast","status"])):v("",!0),m.row[r.dayString+"blocked"]?(u(),y(l,{key:1,onEmptyBlockClick:e.emptyBlockClick,resIdRef:m.row[r.dayString+"resIdRef"],start:m.row[r.dayString+"start"],end:m.row[r.dayString+"end"],span:m.row[r.dayString+"span"],startTruncated:m.row[r.dayString+"starttruncated"],endTruncated:m.row[r.dayString+"endtruncated"]},null,8,["onEmptyBlockClick","resIdRef","start","end","span","startTruncated","endTruncated"])):v("",!0)])]),_:2},1032,["prop","label"]))),256))]),_:1},8,["data","row-style","height","onCellClick","onEmptyBlockClick"])}const Ne=D(Ve,[["render",Ye]]),Fe={name:"DateRangePicker",props:["componentKey","initialStart","initialEnd"],emits:["dateRangePicker:rangeSelected","dateRangePicker:clearDates"],data(){return{dRange:null}},computed:{endDate(){return this.dRange?g(this.dRange[1]).format("YYYY-MM-DD"):null},endPlaceholder(){return this.$t("message.endDate")},labelDates(){return this.$t("message.dates")},locale(){return F().selectedLocale},rSeperator(){return this.$t("message.to")},startDate(){return this.dRange?g(this.dRange[0]).format("YYYY-MM-DD"):null},startPlaceholder(){return this.$t("message.startDate")}},mounted(){this.initialStart&&this.initialEnd&&(this.dRange=[this.initialStart,this.initialEnd])},watch:{componentKey(e){this.dRange=null,this.$emit("dateRangePicker:rangeSelected",[null,null])},dRange(e,t){if(this.startDate!=null&&this.endDate!=null)if(this.startDate==this.endDate)N({type:"warning",message:"Start and end must be different"}),this.$emit("dateRangePicker:clearDates");else{const a=[g(this.dRange[0]).format("YYYY-MM-DD"),g(this.dRange[1]).format("YYYY-MM-DD")];this.$emit("dateRangePicker:rangeSelected",a)}}}};function Be(e,t,a,i,s,l){const n=d("el-date-picker"),r=d("el-form-item"),m=d("el-form"),_=d("el-config-provider");return u(),k("div",null,[o(_,{locale:l.locale},{default:c(()=>[o(m,{"label-width":"120px",size:"small"},{default:c(()=>[o(r,{label:l.labelDates},{default:c(()=>[o(n,{modelValue:s.dRange,"onUpdate:modelValue":t[0]||(t[0]=S=>s.dRange=S),type:"daterange",size:"small",format:"D-MMM-YYYY",clearable:!1,"range-separator":l.rSeperator,"start-placeholder":l.startPlaceholder,"end-placeholder":l.endPlaceholder},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["locale"])])}const Ee=D(Fe,[["render",Be]]),Le={name:"RootSpacePicker",props:["availableSpaceIds","componentKey"],emits:["rootSpacePicker:spaceSelected"],data(){return{rootSpaces:null,selectedRootSpace:null}},computed:{availableSpaces(){if(this.rootSpaces&&this.availableSpaceIds){let e=[];return b.each(this.rootSpaces,t=>{b.includes(this.availableSpaceIds,t.id)&&e.push(t)}),e}else return[]},initialSpaceIdSelected(){return!!this.selectedSpaceId},labelSpace(){return this.$t("message.spaceLabel")},locale(){return this.$i18n},placeholder(){return this.$t("message.select")},token(){return Y().token}},created(){x.rootSpaces.getRootSpaces(this.token).then(e=>{this.rootSpaces=e.data.root_spaces_children_parents})},watch:{componentKey(e){console.log("cKey on rSP"),this.selectedRootSpace=null},selectedRootSpace(e,t){this.$emit("rootSpacePicker:spaceSelected",this.selectedRootSpace)},availableSpaceIds(e,t){this.selectedRootSpace=null}}};function Ke(e,t,a,i,s,l){const n=d("el-option"),r=d("el-select"),m=d("el-config-provider"),_=d("el-form-item"),S=d("el-form");return u(),k("div",null,[o(S,{"label-width":"120px",size:"small",class:"cust-form"},{default:c(()=>[o(_,{label:l.labelSpace},{default:c(()=>[o(m,{locale:l.locale},{default:c(()=>[s.rootSpaces?(u(),y(r,{key:0,modelValue:s.selectedRootSpace,"onUpdate:modelValue":t[0]||(t[0]=h=>s.selectedRootSpace=h),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(l.availableSpaces,h=>(u(),y(n,{label:h.title,value:h.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])):v("",!0)]),_:1},8,["locale"])]),_:1},8,["label"])]),_:1})])}const Ae=D(Le,[["render",Ke]]),qe={name:"SearchCustomers",props:["componentKey"],emits:["searchCustomers:customerSelected"],data(){return{customers:[],form:{firstName:"",lastName:""},currentPage:1,pageSize:10,rowCount:0}},computed:{labelCustomer(){return this.$t("message.customer")},labelFirstName(){return this.$t("message.firstName")},labelLastName(){return this.$t("message.lastName")},offset(){return(this.currentPage-1)*this.pageSize},token(){return Y().token}},methods:{searchC(){try{x.customers.searchCustomers(this.form.lastName,this.form.firstName,this.token,this.offset,this.pageSize).then(e=>{console.log(e.data),this.customers=e.data.customers,this.rowCount=e.data.count}).catch(e=>{M({message:e,type:"warning"})})}catch{M({message:"Error requesting data from server",type:"warning"})}},selectCustomer(e){this.$emit("searchCustomers:customerSelected",e)}},watch:{componentKey(e){this.form.firstName="",this.form.lastName="",this.rowCount=0,this.customers=[]},currentPage(e){this.currentPage=e},offset(e){this.searchC()},pageSize(e){this.searchC()}}};function Ue(e,t,a,i,s,l){const n=d("el-input"),r=d("el-col"),m=d("el-form-item"),_=d("el-button"),S=d("el-form"),h=d("el-table-column"),C=d("el-table"),P=d("el-pagination"),V=d("el-config-provider");return u(),y(V,null,{default:c(()=>[o(S,{"label-width":"120px",size:"small"},{default:c(()=>[o(m,{label:l.labelCustomer},{default:c(()=>[o(r,{span:11},{default:c(()=>[o(n,{modelValue:s.form.lastName,"onUpdate:modelValue":t[0]||(t[0]=R=>s.form.lastName=R),placeholder:l.labelLastName},null,8,["modelValue","placeholder"])]),_:1}),o(r,{span:11},{default:c(()=>[o(n,{modelValue:s.form.firstName,"onUpdate:modelValue":t[1]||(t[1]=R=>s.form.firstName=R),placeholder:l.labelFirstName},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["label"]),o(m,null,{default:c(()=>[o(_,{type:"primary",onClick:l.searchC},{default:c(()=>[w(f(e.$t("message.searchCustomers")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),o(C,{data:s.customers,size:"small",style:{width:"100%"},height:"200px",onRowClick:l.selectCustomer},{default:c(()=>[o(h,{fixed:"",prop:"last_name",label:l.labelLastName,width:"100"},null,8,["label"]),o(h,{fixed:"",prop:"first_name",label:l.labelFirstName,width:"100"},null,8,["label"]),o(h,{prop:"email",label:"Email",width:"120"}),o(h,{prop:"address1",label:"Address 1",width:"120"}),o(h,{prop:"address2",label:"Address 2",width:"120"}),o(h,{prop:"city",label:"City",width:"120"}),o(h,{prop:"region",label:"Region",width:"120"}),o(h,{prop:"country",label:"Country",width:"120"}),o(h,{prop:"postalCode",label:"PostalCode",width:"120"})]),_:1},8,["data","onRowClick"]),o(P,{"current-page":s.currentPage,"onUpdate:current-page":t[2]||(t[2]=R=>s.currentPage=R),"page-size":s.pageSize,"onUpdate:page-size":t[3]||(t[3]=R=>s.pageSize=R),background:"",layout:"sizes, prev, pager, next",total:s.rowCount,"page-sizes":[1,10,20,30,40,50]},null,8,["current-page","page-size","total"])]),_:1})}const q=D(qe,[["render",Ue]]);G.warning=function(){};const Qe={name:"CreateCustomer",props:["componentKey"],emits:["createCustomer:customerCreated"],data(){return{customerForm:{firstName:"",lastName:"",email:"",phone:""},rules:{firstName:[{required:!0,message:()=>this.$t("message.firstNameIsRequired")},{min:1,max:24,message:"1 to 24"}],lastName:[{required:!0,message:()=>this.$t("message.lastNameIsRequired")},{min:2,max:24,message:"2 to 24"}],email:[{type:"email",message:()=>this.$t("message.enterCorrectEmail")}],phone:[{pattern:/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/,message:"enter a correct phone"}]}}},computed:{labelEmail(){return this.$t("message.email")},labelFirstName(){return this.$t("message.firstName")},labelLastName(){return this.$t("message.lastName")},labelPhone(){return this.$t("message.phone")},locale(){return F().selectedLocale},token(){return Y().token}},methods:{submitForm(e){this.$refs[e].validate(t=>{if(t)x.customers.createCustomer(this.token,this.customerForm.lastName,this.customerForm.firstName,this.customerForm.email,this.customerForm.phone).then(a=>{console.log(a),a.data.createCustomer&&a.data.newCustomer&&this.$emit("createCustomer:customerCreated",a.data.newCustomer)});else return console.log("error submit!!"),!1})},resetForm(e){this.$refs[e].resetFields()}},watch:{componentKey(e){this.customerForm.firstName="",this.customerForm.lastName="",this.customerForm.email="",this.customerForm.phone=""}}};function Oe(e,t,a,i,s,l){const n=d("el-input"),r=d("el-form-item"),m=d("el-button"),_=d("el-form"),S=d("el-config-provider");return u(),y(S,{locale:l.locale},{default:c(()=>[o(_,{model:s.customerForm,rules:s.rules,size:"small",ref:"createCustomerForm","label-width":"120px"},{default:c(()=>[o(r,{label:l.labelFirstName,prop:"firstName"},{default:c(()=>[o(n,{modelValue:s.customerForm.firstName,"onUpdate:modelValue":t[0]||(t[0]=h=>s.customerForm.firstName=h)},null,8,["modelValue"])]),_:1},8,["label"]),o(r,{label:l.labelLastName,prop:"lastName"},{default:c(()=>[o(n,{modelValue:s.customerForm.lastName,"onUpdate:modelValue":t[1]||(t[1]=h=>s.customerForm.lastName=h)},null,8,["modelValue"])]),_:1},8,["label"]),o(r,{label:l.labelEmail,prop:"email"},{default:c(()=>[o(n,{modelValue:s.customerForm.email,"onUpdate:modelValue":t[2]||(t[2]=h=>s.customerForm.email=h)},null,8,["modelValue"])]),_:1},8,["label"]),o(r,{label:l.labelPhone,prop:"phone"},{default:c(()=>[o(n,{modelValue:s.customerForm.phone,"onUpdate:modelValue":t[3]||(t[3]=h=>s.customerForm.phone=h)},null,8,["modelValue"])]),_:1},8,["label"]),o(r,null,{default:c(()=>[o(m,{type:"primary",onClick:t[4]||(t[4]=h=>l.submitForm("createCustomerForm"))},{default:c(()=>[w(f(e.$t("message.createCustomer")),1)]),_:1}),o(m,{onClick:t[5]||(t[5]=h=>l.resetForm("createCustomerForm"))},{default:c(()=>[w(f(e.$t("message.reset")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["locale"])}const U=D(Qe,[["render",Oe]]),Ge={name:"ResBedsPicker",props:["componentKey","initialBedsQty"],emits:["resBedsPicker:bedQtyChosen"],data(){return{arr:[1,2,3,4,5,6,7,8,9,10],selectedBedQty:null}},computed:{labelNumberOfBeds(){return this.$t("message.numberOfBeds")},locale(){return this.$i18n},placeholder(){return this.$t("message.select")}},mounted(){this.initialBedsQty&&(this.selectedBedQty=this.initialBedsQty)},watch:{componentKey(e){this.selectedBedQty=null},selectedBedQty(e,t){this.$emit("resBedsPicker:bedQtyChosen",this.selectedBedQty)}}};function He(e,t,a,i,s,l){const n=d("el-option"),r=d("el-select"),m=d("el-form-item"),_=d("el-form"),S=d("el-config-provider");return u(),k("div",null,[o(S,null,{default:c(()=>[o(_,{"label-width":"120px",size:"small"},{default:c(()=>[o(m,{label:l.labelNumberOfBeds},{default:c(()=>[o(r,{modelValue:s.selectedBedQty,"onUpdate:modelValue":t[0]||(t[0]=h=>s.selectedBedQty=h),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(s.arr,h=>(u(),y(n,{label:h,value:h},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})])}const je=D(Ge,[["render",He]]),$e={name:"ResPeoplePicker",props:["componentKey","initialPeopleQty"],emits:["resPeoplePicker:peopleQtyChosen"],data(){return{arr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],selectedPeopleQty:null}},computed:{labelPeople(){return this.$t("message.people")},locale(){return F().selectedLocale},placeholder(){return this.$t("message.select")}},mounted(){this.initialPeopleQty&&(this.selectedPeopleQty=this.initialPeopleQty)},watch:{componentKey(e,t){console.log("componentKey change on resPoeplePic",t),this.selectedPeopleQty=null},selectedPeopleQty(e,t){console.log(this.$i18n),this.$emit("resPeoplePicker:peopleQtyChosen",this.selectedPeopleQty)}}};function We(e,t,a,i,s,l){const n=d("el-option"),r=d("el-select"),m=d("el-form-item"),_=d("el-form"),S=d("el-config-provider");return u(),k("div",null,[o(S,{locale:l.locale},{default:c(()=>[o(_,{"label-width":"120px",size:"small"},{default:c(()=>[o(m,{label:l.labelPeople},{default:c(()=>[o(r,{modelValue:s.selectedPeopleQty,"onUpdate:modelValue":t[0]||(t[0]=h=>s.selectedPeopleQty=h),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(s.arr,h=>(u(),y(n,{label:h,value:h},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["locale"])])}const Je=D($e,[["render",We]]),L=()=>{const e=()=>{Y().setAccountToGuest(),H.push({path:"/Login"})};return{handleRequestError:a=>{if(a)if(a.response)if(a.response.status)switch(a.response.status){case 400:M({title:"Error 400 - Bad Request",duration:0,message:"The request was malformed.  Request was not processed",type:"error"});break;case 401:M({title:"Error 401 - Unauthorized",duration:4500,message:"Authorization failed.  Request was not processed.",type:"error",onClose:e});break;case 403:M({title:"Error 403 - Forbidden",duration:0,message:"You are not allowed to perform this task.  Request was not processed",type:"error",onClose:e});break;case 404:M({title:"Error 404 - Not found",duration:4500,message:"The location of this this request was not found",type:"error"});case 500:M({title:"Server Error",duration:4500,message:"There was an error on the server.  Request was not processed",type:"error"});break;default:M({title:"Error",duration:4500,message:"There was an error.  Request was not processed",type:"error"})}else M({title:"Error",duration:4500,message:"There was an error.  Request was not processed",type:"error"});else M({title:"Error",duration:0,message:"There was an error 1.  Request was not processed",type:"error"});else M({title:"Error",duration:0,message:"There was an error 2.  Request was not processed",type:"error"})}}},Xe={setup(){const{handleRequestError:e}=L();return{handleRequestError:e}},name:"CreateReservation",emits:["createReservation:reloadReservations","createReservation:closeDrawer"],components:{DateRangePicker:Ee,RootSpacePicker:Ae,SearchCustomers:q,CreateCustomer:U,ResBedsPicker:je,ResPeoplePicker:Je},data(){return{availableSpaceIds:null,selectedCustomer:null,showCreateCustomer:!1,showSearchCustomers:!1,startDate:null,endDate:null,selectedSpaceId:null,selectedPeople:null,selectedBeds:null,componentKey:0}},computed:{labelCustomer(){return this.$t("message.customer")},fStartDate(){return this.startDate?g(this.startDate).format("YYYY-MM-DD"):null},fEndDate(){return this.endDate?g(this.endDate).format("YYYY-MM-DD"):null},token(){return Y().token}},methods:{bedQtyChosen(e){console.log("gotem beds on create res",e),this.selectedBeds=e},checkConflicts(){x.reservations.checkConflicts(this.fStartDate,this.fEndDate,this.selectedSpaceId,this.token).then(e=>{console.log(e)}).catch(e=>{handleError(e)})},createReservation(){x.reservations.createReservation(this.token,this.fStartDate,this.fEndDate,this.selectedCustomer,this.selectedSpaceId,this.selectedPeople,this.selectedBeds).then(e=>{e.data.create.execute_res_sql==!0&&(N({type:"success",message:"Reservation was created"}),this.$emit("createReservation:reloadReservations"),this.resetForm())}).catch(e=>{console.log("error",e),this.handleRequestError(e)})},customerSelected(e){console.log(e),this.selectedCustomer=e},dRangeClearDates(){this.startDate=null,this.endDate=null,this.availableSpaceIds=null},dRangeSelected(e){console.log("dRange @ change on createres",e),e[0]&&e[1]?(this.startDate=e[0],this.endDate=e[1],x.reservations.checkAvailabilityByDates(this.fStartDate,this.fEndDate,this.token).then(t=>{console.log(t.data),this.availableSpaceIds=t.data.availability.availableSpaceIds})):(this.availableSpaceIds=[],this.startDate=null,this.endDate=null)},peopleQtyChosen(e){console.log("people chosen: ",e),this.selectedPeople=e},resetForm(){this.componentKey+=1,this.availableSpaceIds=[],this.selectedCustomer=null,this.showCreateCustomer=!1,this.showSearchCustomers=!1},spaceSelected(e){console.log(e),this.selectedSpaceId=e}}},Ze=p("hr",null,null,-1),et={key:0},tt={key:0},st=p("hr",null,null,-1),lt=p("hr",null,null,-1);function at(e,t){const a=d("el-button"),i=d("el-form-item"),s=d("el-form"),l=d("SearchCustomers"),n=d("CreateCustomer"),r=d("ResPeoplePicker"),m=d("ResBedsPicker"),_=d("DateRangePicker"),S=d("RootSpacePicker"),h=d("el-col"),C=d("el-row");return u(),y(C,null,{default:c(()=>[o(h,null,{default:c(()=>[p("h1",null,f(e.$t("message.createReservation")),1),o(a,{type:"primary",size:"small",onClick:e.resetForm},{default:c(()=>[w("Reset Form")]),_:1},8,["onClick"]),Ze,p("div",null,[p("span",null,[e.selectedCustomer?(u(),k("span",et,[w(f(e.$t("message.customer"))+":\xA0",1),p("b",null,f(e.selectedCustomer.first_name)+"\xA0"+f(e.selectedCustomer.last_name),1)])):v("",!0),e.selectedCustomer?(u(),y(a,{key:1,type:"warning",size:"small",style:{float:"right"},onClick:t[0]||(t[0]=P=>{e.selectedCustomer=null,e.showSearchCustomers=null,e.showCreateCustomer=null})},{default:c(()=>[w(f(e.$t("message.reset")),1)]),_:1})):v("",!0)])]),p("div",null,[e.selectedCustomer?v("",!0):(u(),k("span",tt,[o(s,{size:"small"},{default:c(()=>[o(i,{label:e.labelCustomer},{default:c(()=>[o(a,{size:"small",type:"primary",onClick:t[1]||(t[1]=P=>{e.showSearchCustomers=!0,e.showCreateCustomer=!1})},{default:c(()=>[w(f(e.$t("message.search")),1)]),_:1}),o(a,{size:"small",type:"primary",onClick:t[2]||(t[2]=P=>{e.showCreateCustomer=!0,e.showSearchCustomers=!1})},{default:c(()=>[w(f(e.$t("message.create")),1)]),_:1})]),_:1},8,["label"])]),_:1})]))]),e.showSearchCustomers&&!e.selectedCustomer?(u(),y(l,{key:0,componentKey:e.componentKey,"onSearchCustomers:customerSelected":e.customerSelected},null,8,["componentKey","onSearchCustomers:customerSelected"])):v("",!0),e.showCreateCustomer&&!e.selectedCustomer?(u(),y(n,{key:1,componentKey:e.componentKey,"onCreateCustomer:customerCreated":e.customerSelected},null,8,["componentKey","onCreateCustomer:customerCreated"])):v("",!0),st,o(r,{componentKey:e.componentKey,"onResPeoplePicker:peopleQtyChosen":e.peopleQtyChosen},null,8,["componentKey","onResPeoplePicker:peopleQtyChosen"]),o(m,{componentKey:e.componentKey,"onResBedsPicker:bedQtyChosen":e.bedQtyChosen},null,8,["componentKey","onResBedsPicker:bedQtyChosen"]),o(_,{componentKey:e.componentKey,"onDateRangePicker:rangeSelected":e.dRangeSelected,"onDateRangePicker:clearDates":e.dRangeClearDates},null,8,["componentKey","onDateRangePicker:rangeSelected","onDateRangePicker:clearDates"]),e.availableSpaceIds?(u(),y(S,{key:2,componentKey:e.componentKey,availableSpaceIds:e.availableSpaceIds,"onRootSpacePicker:spaceSelected":e.spaceSelected},null,8,["componentKey","availableSpaceIds","onRootSpacePicker:spaceSelected"])):v("",!0),lt,e.startDate&&e.endDate&&e.selectedCustomer&&e.selectedSpaceId&&e.selectedPeople&&e.selectedBeds?(u(),y(i,{key:3},{default:c(()=>[o(a,{type:"primary",size:"small",onClick:e.createReservation},{default:c(()=>[w(f(e.$t("message.createReservation")),1)]),_:1},8,["onClick"]),o(a,{type:"primary",size:"small",onClick:e.checkConflicts},{default:c(()=>[w(f(e.$t("message.availability")),1)]),_:1},8,["onClick"])]),_:1})):v("",!0)]),_:1})]),_:1})}const ot=D(Xe,[["render",at]]),nt={name:"EditReservation",props:["componentKey","resId","checkin","checkout","people","beds","spaceId","customer","customerFirst","customerLast"],emits:["edit-reservation:modify-reservation-1"],components:{SearchCustomers:q,CreateCustomer:U},data(){return{cResId:this.resId,cCheckin:this.checkin,cCheckout:this.checkout,cPeople:this.people,cBeds:this.beds,cSpaceId:this.spaceId,cCustomer:this.customer,cCustomerFirst:this.customerFirst,cCustomerLast:this.customerLast,componentKey2:0,availableSpaceIds:[],availableSpaces:[],rootSpaces:null,showCreateCustomer:!1,showSearchCustomers:!1,selectedSpace:"",bedsSelectArr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],peopleSelectArr:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]}},computed:{bedsPickerLabel(){return this.$t("message.beds")},cCheckinF(){return g(this.cDateRange[0]).format("YYYY-MM-DD")},cCheckoutF(){return g(this.cDateRange[1]).format("YYYY-MM-DD")},cDateRange:{get(){return[this.cCheckin,this.cCheckout]},set(e){this.cCheckin=g(e[0]).format("YYYY-MM-DD"),this.cCheckout=g(e[1]).format("YYYY-MM-DD")}},editReady(){return!!this.selectedSpace},locale(){return F().selectedLocale},token(){return Y().token},peoplePickerLabel(){return this.$t("message.people")},placeholder(){return this.$t("message.select")},rangePickerEndPlaceholder(){return this.$t("message.endDate")},rangePickerLabelDates(){return this.$t("message.dates")},rangePickerSeperator(){return this.$t("message.to")},rangePickerStartPlaceholder(){return this.$t("message.startDate")},spacePickerLabel(){return this.$t("message.spaceLabel")}},methods:{createCustomerSelected(e){console.log("cust created",e),this.cCustomer=e.id,this.cCustomerFirst=e.firstName,this.cCustomerLast=e.lastName,this.componentKey+=1,this.showCreateCustomer=!1},loadAvailableSpaces(){let e=[];b.each(this.rootSpaces,t=>{b.includes(this.availableSpaceIds,t.id)&&e.push(t)}),console.log("av Sp",e),this.availableSpaces=e},loadAvailableSpaceIds(){x.reservations.checkAvailabilityByDatesIgnoreRes(this.resId,this.cCheckinF,this.cCheckoutF,this.token).then(e=>{console.log(e),this.availableSpaceIds=e.data.availableSpaceIds,this.loadAvailableSpaces(),this.selectedSpace=null})},revertToProps(){this.cCheckin=this.checkin,this.cCheckout=this.checkout,this.cPeople=this.people,this.cBeds=this.beds,this.cCustomer=this.customer,this.cCustomerFirst=this.customerFirst,this.cCustomerLast=this.customerLast,this.selectedSpace=null,this.showSearchCustomers=!1,this.showCreateCustomer=!1},searchCustomerSelected(e){console.log(e),this.cCustomer=e.id,this.cCustomerFirst=e.firstName,this.cCustomerLast=e.lastName,this.componentKey2+=1,this.showSearchCustomers=!1},updateReservation(){const e={res_id:this.cResId,customer:this.cCustomer,space_id:this.selectedSpace,people:this.cPeople,beds:this.cBeds,checkin:this.cCheckinF,checkout:this.cCheckoutF};this.$emit("edit-reservation:modify-reservation-1",e)}},mounted(){x.reservations.checkAvailabilityByDatesIgnoreRes(this.resId,this.checkin,this.checkout,this.token).then(e=>{console.log(e),this.availableSpaceIds=e.data.availableSpaceIds,this.rootSpaces=E().rootSpaces,this.loadAvailableSpaces()})},watch:{componentKey(e){this.revertToProps()},resId(e){this.cResId=e},checkin(e){this.cCheckin=e},checkout(e){this.cCheckout=e},people(e){this.cPeople=e},beds(e){this.cBeds=e},spaceId(e){this.cSpaceId=e},customer(e){this.cCustomer=e},customerFirst(e){this.cCustomerFirst=e},customerLast(e){this.cCustomerLast=e},cDateRange(e){console.log("cDateRange change",e),this.loadAvailableSpaceIds()}}},rt={key:0},it=p("hr",null,null,-1),ct=p("hr",null,null,-1);function dt(e,t,a,i,s,l){const n=d("el-button"),r=d("SearchCustomers"),m=d("CreateCustomer"),_=d("el-option"),S=d("el-select"),h=d("el-form-item"),C=d("el-date-picker"),P=d("el-form"),V=d("el-config-provider");return s.rootSpaces?(u(),k("div",rt,[it,p("div",null," Customer: "+f(s.cCustomerFirst)+"\xA0"+f(s.cCustomerLast),1),p("div",null,[o(n,{onClick:t[0]||(t[0]=R=>(s.showSearchCustomers=!0,s.showCreateCustomer=!1)),size:"small"},{default:c(()=>[w(f(e.$t("message.searchCustomers")),1)]),_:1}),s.showSearchCustomers?(u(),y(n,{key:0,onClick:t[1]||(t[1]=R=>s.showSearchCustomers=!1),size:"small"},{default:c(()=>[w("cancel")]),_:1})):v("",!0)]),p("div",null,[o(n,{onClick:t[2]||(t[2]=R=>(s.showCreateCustomer=!0,e.createCustomer=!1)),size:"small"},{default:c(()=>[w(f(e.$t("message.createCustomer")),1)]),_:1}),s.showCreateCustomer?(u(),y(n,{key:0,onClick:t[3]||(t[3]=R=>s.showCreateCustomer=!1),size:"small"},{default:c(()=>[w("cancel")]),_:1})):v("",!0)]),s.showSearchCustomers?(u(),y(r,{key:0,componentKey:s.componentKey2,"onSearchCustomers:customerSelected":l.searchCustomerSelected},null,8,["componentKey","onSearchCustomers:customerSelected"])):v("",!0),s.showCreateCustomer?(u(),y(m,{key:1,componentKey:s.componentKey2,"onCreateCustomer:customerCreated":l.createCustomerSelected},null,8,["componentKey","onCreateCustomer:customerCreated"])):v("",!0),ct,o(V,{locale:l.locale},{default:c(()=>[o(P,{"label-width":"70px",size:"small"},{default:c(()=>[o(h,{label:l.peoplePickerLabel},{default:c(()=>[o(S,{modelValue:s.cPeople,"onUpdate:modelValue":t[4]||(t[4]=R=>s.cPeople=R),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(s.peopleSelectArr,R=>(u(),y(_,{label:R,value:R},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(h,{label:l.bedsPickerLabel},{default:c(()=>[o(S,{modelValue:s.cBeds,"onUpdate:modelValue":t[5]||(t[5]=R=>s.cBeds=R),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(s.bedsSelectArr,R=>(u(),y(_,{label:R,value:R},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(h,{label:l.rangePickerLabelDates},{default:c(()=>[o(C,{modelValue:l.cDateRange,"onUpdate:modelValue":t[6]||(t[6]=R=>l.cDateRange=R),type:"daterange",size:"small",format:"D-MMM-YYYY",clearable:!1,"range-separator":l.rangePickerSeperator,"start-placeholder":l.rangePickerStartPlaceholder,"end-placeholder":l.rangePickerEndPlaceholder},null,8,["modelValue","range-separator","start-placeholder","end-placeholder"])]),_:1},8,["label"]),o(h,{label:l.spacePickerLabel},{default:c(()=>[this.rootSpaces&&this.cSpaceId&&this.availableSpaceIds?(u(),y(S,{key:0,modelValue:this.selectedSpace,"onUpdate:modelValue":t[7]||(t[7]=R=>this.selectedSpace=R),placeholder:l.placeholder},{default:c(()=>[(u(!0),k(T,null,I(this.availableSpaces,R=>(u(),y(_,{label:R.title,value:R.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue","placeholder"])):v("",!0)]),_:1},8,["label"])]),_:1})]),_:1},8,["locale"]),p("div",null,[l.editReady?(u(),y(n,{key:0,onClick:l.updateReservation,type:"success"},{default:c(()=>[w("Save")]),_:1},8,["onClick"])):v("",!0),o(n,{onClick:l.revertToProps,type:"info"},{default:c(()=>[w("revert")]),_:1},8,["onClick"])])])):v("",!0)}const ut=D(nt,[["render",dt]]),mt={name:"ProcessSaleType",props:["saleType","processSaleTypeResetKey"],emits:["process-sale-type:add-sale-item"],data(){return{description:"",saleQuantities:[-5,-4,-3,-2,-1,1,2,3,4,5],iSale:null}},computed:{subtotal(){return Number(this.iSale.price*this.iSale.quantity).toFixed(2)},saleTotal(){return this.iSale&&this.subtotal&&this.totalTax?Number(Number(this.subtotal)+Number(this.totalTax)).toFixed(2):null},saleTypes(){return A().saleTypes},taxRate(){if(this.iSale){const e=this.iSale.tax_types;let t=0;return b.each(e,a=>{const i=b.find(this.taxTypes,s=>s.id==a);t=Number(t)+Number(i.tax_rate)}),Number(t)}else return null},taxSpread(){if(this.iSale&&this.subtotal){let e=[];return b.each(this.iSale.tax_types,t=>{let a={};const i=b.find(this.taxTypes,s=>s.id==t);a.i=t,a.r=i.tax_rate,a.t=Number(i.tax_rate*this.subtotal).toFixed(2),e.push(a)}),e}else return null},taxTypes(){return j().taxTypes},totalTax(){return this.taxRate!=null?(this.subtotal*Number(this.taxRate)).toFixed(2):null}},methods:{addToSale(){const e={saleType:this.iSale.id,saleTitle:this.iSale.title,saleQuantity:this.iSale.quantity,salePrice:this.iSale.price,saleSubtotal:this.subtotal,saleTax:this.totalTax,saleTotal:this.saleTotal,taxTypes:this.iSale.tax_types,taxSpread:this.taxSpread,description:this.iSale.description};this.$emit("process-sale-type:add-sale-item",e)}},watch:{saleType(e){console.log("watch on process sale type",e),e?(e.quantity=1,e.description=e.title,e.is_fixed_price?e.price=e.fixed_price:e.price=null,this.iSale=e):this.iSale=null}}},ht={class:"process-sale-wrapper"};function pt(e,t,a,i,s,l){const n=d("el-input"),r=d("el-form-item"),m=d("el-option"),_=d("el-select"),S=d("el-form"),h=d("el-button");return u(),k("div",ht,[s.iSale?(u(),y(S,{key:0,size:"small",inline:!0,"label-position":"top"},{default:c(()=>[o(r,{label:"Type"},{default:c(()=>[o(n,{disabled:"",modelValue:s.iSale.title,"onUpdate:modelValue":t[0]||(t[0]=C=>s.iSale.title=C)},null,8,["modelValue"])]),_:1}),o(r,{label:"Qty",style:{width:"60px"}},{default:c(()=>[o(_,{modelValue:s.iSale.quantity,"onUpdate:modelValue":t[1]||(t[1]=C=>s.iSale.quantity=C)},{default:c(()=>[(u(!0),k(T,null,I(s.saleQuantities,C=>(u(),y(m,{label:C,value:C},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),Boolean(Number(s.iSale.is_fixed_price))?(u(),y(r,{key:0,label:"Amount",style:{width:"80px"}},{default:c(()=>[o(n,{disabled:"",modelValue:s.iSale.price,"onUpdate:modelValue":t[2]||(t[2]=C=>s.iSale.price=C)},null,8,["modelValue"])]),_:1})):v("",!0),Boolean(Number(s.iSale.is_fixed_price))?v("",!0):(u(),y(r,{key:1,label:"Amount",style:{width:"80px"}},{default:c(()=>[o(n,{modelValue:s.iSale.price,"onUpdate:modelValue":t[3]||(t[3]=C=>s.iSale.price=C)},null,8,["modelValue"])]),_:1})),o(r,{label:"Subtotal",style:{width:"80px"}},{default:c(()=>[o(n,{disabled:"",modelValue:l.subtotal,"onUpdate:modelValue":t[4]||(t[4]=C=>l.subtotal=C)},null,8,["modelValue"])]),_:1}),o(r,{label:"Tax",style:{width:"80px"}},{default:c(()=>[o(n,{disabled:"",modelValue:l.totalTax,"onUpdate:modelValue":t[5]||(t[5]=C=>l.totalTax=C)},null,8,["modelValue"])]),_:1}),o(r,{label:"Total",style:{width:"80px"}},{default:c(()=>[o(n,{disabled:"",modelValue:l.saleTotal,"onUpdate:modelValue":t[6]||(t[6]=C=>l.saleTotal=C)},null,8,["modelValue"])]),_:1})]),_:1})):v("",!0),s.iSale?(u(),y(S,{key:1,size:"small"},{default:c(()=>[o(r,{label:"Description"},{default:c(()=>[o(n,{modelValue:s.iSale.description,"onUpdate:modelValue":t[7]||(t[7]=C=>s.iSale.description=C)},null,8,["modelValue"])]),_:1})]),_:1})):v("",!0),l.saleTotal&&l.saleTotal>0||l.saleTotal<0?(u(),y(S,{key:2},{default:c(()=>[o(r,null,{default:c(()=>[o(h,{onClick:l.addToSale,size:"small",type:"success"},{default:c(()=>[w("Add to sale")]),_:1},8,["onClick"])]),_:1})]),_:1})):v("",!0)])}const ft=D(mt,[["render",pt]]),_t={name:"SaleItems",props:["saleItems"],emits:["sale-items:remove-at-index"],data(){return{}},computed:{saleItemsExist(){return this.saleItems.length>0}},methods:{handleRemoveItem(e){console.log(e),this.$emit("sale-items:remove-at-index",e.$index)}},watch:{saleItems(e){console.log("new prop on saleItems component",e)}}};function yt(e,t,a,i,s,l){const n=d("el-table-column"),r=d("el-button"),m=d("el-table");return u(),y(m,{size:"small",data:a.saleItems,style:{width:"100%"}},{default:c(()=>[o(n,{prop:"saleTitle",width:"140",label:"Type"}),o(n,{prop:"description",label:"Description"}),o(n,{prop:"saleQuantity",width:"40",label:"Qty"}),o(n,{prop:"salePrice",width:"60",label:"Price"}),o(n,{prop:"saleSubtotal",width:"80",label:"Subtotal"}),o(n,{prop:"saleTax",width:"60",label:"Tax"}),o(n,{prop:"saleTotal",width:"60",label:"Total"}),o(n,{width:"40"},{default:c(_=>[o(r,{onClick:S=>l.handleRemoveItem(_),type:"danger",size:"small"},{default:c(()=>[w("X")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])}const St=D(_t,[["render",yt]]),gt={name:"CompleteSale",props:["saleItems"],emits:["compelete-sale:payment-type-selected"],data(){return{selectedPaymentType:null,testMode:!1}},computed:{activePaymentTypes(){return $().activePaymentTypes},saleItemsLength(){return this.saleItems.length},saleTotal(){let e=0;return b.each(this.saleItems,t=>{e+=Number(t.saleTotal)}),Number(e).toFixed(2)}},methods:{paymentTypeSelected(){console.log("p",this.selectedPaymentType),this.$emit("compelete-sale:payment-type-selected",this.selectedPaymentType)}}},vt={key:0},kt=p("hr",null,null,-1),Ct={style:{display:"flex"}};function wt(e,t,a,i,s,l){const n=d("el-option"),r=d("el-select"),m=d("el-button");return u(),k(T,null,[s.testMode?(u(),k("div",vt,[p("div",null,"sil: "+f(l.saleItemsLength),1),p("div",null,"t: "+f(l.saleTotal),1)])):v("",!0),kt,p("div",Ct,[p("span",null,"Total: "+f(l.saleTotal),1),o(r,{style:{"margin-left":"auto"},modelValue:s.selectedPaymentType,"onUpdate:modelValue":t[0]||(t[0]=_=>s.selectedPaymentType=_)},{default:c(()=>[(u(!0),k(T,null,I(l.activePaymentTypes,_=>(u(),y(n,{value:_.id,label:_.payment_title},null,8,["value","label"]))),256))]),_:1},8,["modelValue"]),s.selectedPaymentType?(u(),y(m,{key:0,onClick:l.paymentTypeSelected,type:"success",style:{"margin-left":"auto"}},{default:c(()=>[w("CompleteSale")]),_:1},8,["onClick"])):(u(),y(m,{key:1,disabled:"",type:"success",style:{"margin-left":"auto"}},{default:c(()=>[w("CompleteSale")]),_:1}))])],64)}const bt=D(gt,[["render",wt]]),Rt={name:"FolioDisplay",props:["selectedReservation","folioViewerReloadKey"],data(){return{folioDataLoaded:!1,folioData:[]}},computed:{allSaleItems(){let e=[];return b.each(this.folioData.sale_items,t=>{e.push(t)}),e},allSalePayments(){let e=[];return b.each(this.folioData.payments,t=>{e.push(t)}),e},token(){return Y().token}},methods:{getFolio1(){x.folios.getFolio1(this.token,this.selectedReservation.folio).then(e=>{console.log(e.data),console.log(JSON.stringify(e.data)),this.folioData=e.data.folio_to_array,this.folioDataLoaded=!0})}},created(){console.log("folioDisplay created"),this.getFolio1()},watch:{folioViewerReloadKey(e){console.log("foliodispaly gets reload key"),this.folioData=[],this.folioDataLoaded=!1,this.getFolio1()}}},Pt={key:0,class:"folio-display-wrapper"},Dt=p("div",{style:{"font-size":"1.5em"}},"Sale Items",-1),zt=p("hr",null,null,-1),Tt=p("div",{style:{"font-size":"1.5em"}},"Payments",-1);function xt(e,t,a,i,s,l){const n=d("el-table-column"),r=d("el-table");return s.folioDataLoaded?(u(),k("div",Pt,[Dt,o(r,{size:"small",data:l.allSaleItems,"max-height":"250",style:{width:"100%"},"show-summary":"",stripe:""},{default:c(()=>[o(n,{prop:"sale_datetime",width:"143",label:"Date"}),o(n,{prop:"description",label:"Description"}),o(n,{prop:"sale_quantity",width:"70",label:"Qty"}),o(n,{prop:"sale_price",width:"70",label:"Price"}),o(n,{prop:"sale_subtotal",width:"70",label:"Subtotal"}),o(n,{prop:"sale_tax",width:"70",label:"Tax"}),o(n,{prop:"sale_total",width:"70",label:"Total"})]),_:1},8,["data"]),zt,Tt,o(r,{size:"small",data:l.allSalePayments,"max-height":"250",style:{width:"100%"},"show-summary":"",stripe:""},{default:c(()=>[o(n,{prop:"datetime_posted",width:"143",label:"Date"}),o(n,{prop:"total",width:"70",label:"Total"}),o(n,{prop:"payment_type",width:"100",label:"Type"})]),_:1},8,["data"])])):v("",!0)}const Vt=D(Rt,[["render",xt]]),It={name:"SaleGroupSelect",emits:["sale-group-select:group-selected"],computed:{groupSet(){let e=[];return b.each(this.saleTypeGroups,t=>{let a={};a.groupTitle=t.title,a.groupId=t.id;let i=b.filter(this.saleTypes,s=>s.sale_type_group==t.id);a.saleTypes=i,e.push(a)}),e},saleTypeGroups(){return W().saleTypeGroups},saleTypes(){return A().saleTypes}},methods:{handleGroupClick(e){console.log("group click",JSON.parse(JSON.stringify(e))),this.$emit("sale-group-select:group-selected",e)}}};function Mt(e,t,a,i,s,l){const n=d("el-button"),r=d("el-button-group");return u(),k("div",null,[o(r,{type:"primary"},{default:c(()=>[(u(!0),k(T,null,I(l.groupSet,m=>(u(),y(n,{size:"small",onClick:_=>l.handleGroupClick(m)},{default:c(()=>[w(f(m.groupTitle),1)]),_:2},1032,["onClick"]))),256))]),_:1})])}const Yt=D(It,[["render",Mt]]),Nt={name:"SaleTypeSelect",props:["selectedGroup"],emits:["sale-type-picker:sale-type-selected"],data(){return{}},methods:{handleSelectSaleType(e){this.$emit("sale-type-picker:sale-type-selected",e)}}};function Ft(e,t,a,i,s,l){const n=d("el-button"),r=d("el-button-group");return u(),y(r,null,{default:c(()=>[(u(!0),k(T,null,I(a.selectedGroup.saleTypes,m=>(u(),y(n,{type:"primary",size:"small",plain:"",onClick:_=>l.handleSelectSaleType(m)},{default:c(()=>[w(f(m.title),1)]),_:2},1032,["onClick"]))),256))]),_:1})}const Bt=D(Nt,[["render",Ft]]);const Et={name:"FolioView",props:["folioId","selectedReservation","componentKey"],components:{ProcessSaleType:ft,SaleItems:St,CompleteSale:bt,FolioViewer:Vt,SaleGroupSelect:Yt,SaleTypeSelect:Bt},data(){return{folioViewerReloadKey:1,processSaleTypeResetKey:1,rootSpaces:[],saleItems:[],selectedPaymentType:null,selectedGroup:null,selectedSaleType:null}},computed:{rootSpace(){return b.find(this.rootSpaces,t=>t.id==this.selectedReservation.space_id)},saleSubtotal(){let e=0;return b.each(this.saleItems,t=>{e+=Number(t.saleSubtotal)}),e},saleTaxTotal(){let e=0;return b.each(this.saleItems,t=>{e+=Number(t.saleTax)}),e},saleTotal(){let e=0;return b.each(this.saleItems,t=>{e+=Number(t.saleTotal)}),Number(e).toFixed(2)},token(){return Y().token}},methods:{addSaleItem(e){console.log("addSaleItem: ",e),e.taxTypes=Object.values(e.taxTypes),this.saleItems.push(e),this.processSaleTypeResetKey+=1,this.saleTypePickerResetKey+=1,this.selectedSaleType=null,this.selectedGroup=null},groupSelected(e){console.log("setting i",JSON.parse(JSON.stringify(e))),this.selectedGroup=JSON.parse(JSON.stringify(e)),this.selectedSaleType=null},handlePaymentTypeSelected(e){if(this.selectedPaymentType=e,this.saleItems&&this.saleItems.length>0){console.log("here"),this.selectedReservation.id,this.selectedReservation.customer,this.selectedReservation.folioId;const t={resId:this.selectedReservation.id,resCustomer:this.selectedReservation.customer,resFolio:this.selectedReservation.folio,saleItems:this.saleItems,paymentType:e,saleTotal:this.saleTotal,saleSubtotal:this.saleSubtotal,saleTax:this.saleTaxTotal,soldBy:Y().account.id};console.log(t),console.log(JSON.stringify(t)),x.payments.postQuickFolioSale(t,this.token).then(a=>{console.log("quick sale",a.data),a.data.sale_items_posted&&a.data.payment_posted&&(N({type:"success",message:"Transaction completed"}),this.resetSale(),this.folioViewerReloadKey+=1)})}},removeItemAtIndex(e){console.log("rAI",e),this.saleItems.splice(e,1),this.selectedGroup=null},resetSale(){this.selectedGroup=null,this.selectedSaleType=null,this.saleItems=[]},saleTypeSelected(e){e=JSON.parse(JSON.stringify(e)),this.selectedSaleType=e,console.log(e)}},mounted(){z().showHideRootSpaceCopy?this.rootSpaces=z().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces},watch:{folioId(e){this.selectedSaleType=null}}},Lt=p("span",null," : ",-1),Kt={key:0},At=p("hr",null,null,-1),qt=p("hr",null,null,-1);function Ut(e,t,a,i,s,l){const n=d("el-button"),r=d("SaleGroupSelect"),m=d("SaleTypeSelect"),_=d("ProcessSaleType"),S=d("SaleItems"),h=d("CompleteSale"),C=d("el-col"),P=d("FolioViewer"),V=d("el-row");return u(),k("div",null,[o(V,null,{default:c(()=>[o(C,{span:12},{default:c(()=>[p("div",null,f(a.selectedReservation.customer_first)+"\xA0"+f(this.selectedReservation.customer_last),1),p("div",null,[p("span",null,f(a.selectedReservation.checkin),1),Lt,p("span",null,f(a.selectedReservation.checkout),1)]),l.rootSpace?(u(),k("div",Kt,f(e.$t("message.spaceLabel"))+": "+f(l.rootSpace.title),1)):v("",!0),p("div",null,f(e.$t("message.people"))+": "+f(a.selectedReservation.people),1),p("div",null,f(e.$t("message.beds"))+": "+f(a.selectedReservation.beds),1),At,o(n,{type:"danger",size:"small",onClick:l.resetSale},{default:c(()=>[w("Reset Sale")]),_:1},8,["onClick"]),o(r,{"onSaleGroupSelect:groupSelected":l.groupSelected},null,8,["onSaleGroupSelect:groupSelected"]),s.selectedGroup?(u(),y(m,{key:1,selectedGroup:s.selectedGroup,"onSaleTypePicker:saleTypeSelected":l.saleTypeSelected},null,8,["selectedGroup","onSaleTypePicker:saleTypeSelected"])):v("",!0),qt,o(_,{saleType:s.selectedSaleType,processSaleTypeResetKey:s.processSaleTypeResetKey,"onProcessSaleType:addSaleItem":l.addSaleItem},null,8,["saleType","processSaleTypeResetKey","onProcessSaleType:addSaleItem"]),s.saleItems.length>0?(u(),y(S,{key:2,saleItems:s.saleItems,"onSaleItems:removeAtIndex":l.removeItemAtIndex},null,8,["saleItems","onSaleItems:removeAtIndex"])):v("",!0),s.saleItems.length>0?(u(),y(h,{key:3,saleItems:s.saleItems,"onCompeleteSale:paymentTypeSelected":l.handlePaymentTypeSelected},null,8,["saleItems","onCompeleteSale:paymentTypeSelected"])):v("",!0)]),_:1}),o(C,{span:12},{default:c(()=>[o(P,{folioViewerReloadKey:s.folioViewerReloadKey,selectedReservation:a.selectedReservation},null,8,["folioViewerReloadKey","selectedReservation"])]),_:1})]),_:1})])}const Qt=D(Et,[["render",Ut]]);const Ot={setup(){const{handleRequestError:e}=L();return{handleRequestError:e}},name:"ReservationView",props:["selectedReservation"],components:{EditReservation:ut,FolioView:Qt},emits:["reservation-view:close-view","reservation-view:update-reservations","reservation-view:update-selected-reservation"],data(){return{componentKey:1,rootSpaces:null,showHistory:!1,showFolioDialog:!1}},computed:{token(){return Y().token},rootSpace(){return b.find(this.rootSpaces,t=>t.id==this.selectedReservation.space_id)}},methods:{closeReservationView(){this.$emit("reservation-view:close-view")},modifyReservation1(e){console.log("reservationview gets command",e),x.reservations.modifyReservation1(e,this.token).then(t=>{(t.data.success=!0)?(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",t.data.current_res),this.componentKey+=1,N({type:"success",message:"Reservation updated"})):N({type:"warning",message:"There was an error"})}).catch(t=>{this.handleRequestError(t)})},reservationCheckin(){x.reservations.reservationCheckin(this.selectedReservation.id,this.token).then(e=>{e.data.checkin==!0&&e.data.reservation_after_checkin?(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",e.data.reservation_after_checkin),N({type:"success",message:"Reservation checked in"})):N({type:"warning",message:"There was an error"})}).catch(e=>{this.handleRequestError(e)})},reservationCheckout(){x.reservations.reservationCheckout(this.selectedReservation.id,this.token).then(e=>{console.log(e),e.data.checkout==!0&&e.data.reservation_after_checkout&&(this.$emit("reservation-view:update-reservations"),this.$emit("reservation-view:update-selected-reservation",e.data.reservation_after_checkout),N({type:"success",message:"Reservatin checked out"}))}).catch(e=>{this.handleRequestError(e)})}},mounted(){z().showHideRootSpaceCopy?this.rootSpaces=z().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces}},Gt={key:0,class:"wrapper"},Ht=p("br",null,null,-1),jt=p("span",null," : ",-1),$t={key:0},Wt={key:1},Jt={class:"historyTable"};function Xt(e,t,a,i,s,l){const n=d("FolioView"),r=d("el-dialog"),m=d("font-awesome-icon"),_=d("el-button"),S=d("EditReservation"),h=d("el-collapse-item"),C=d("el-collapse");return u(),k(T,null,[o(r,{modelValue:s.showFolioDialog,"onUpdate:modelValue":t[0]||(t[0]=P=>s.showFolioDialog=P),fullscreen:!0,"destroy-on-close":!0},{default:c(()=>[o(n,{folioId:a.selectedReservation.folio,selectedReservation:a.selectedReservation,componentKey:s.componentKey},null,8,["folioId","selectedReservation","componentKey"])]),_:1},8,["modelValue"]),s.rootSpaces&&l.rootSpace?(u(),k("div",Gt,[p("div",null,[o(m,{onClick:l.closeReservationView,color:"#f56c6c",icon:"fa-window-close",size:"xl",style:{float:"right"}},null,8,["onClick"])]),Ht,p("div",null,f(a.selectedReservation.customer_first)+"\xA0"+f(this.selectedReservation.customer_last),1),p("div",null,[p("span",null,f(a.selectedReservation.checkin),1),jt,p("span",null,f(a.selectedReservation.checkout),1)]),p("div",null,f(e.$t("message.spaceLabel"))+": "+f(l.rootSpace.title),1),p("div",null,f(e.$t("message.people"))+": "+f(a.selectedReservation.people),1),p("div",null,f(e.$t("message.beds"))+": "+f(a.selectedReservation.beds),1),p("div",null,"Res Id : "+f(a.selectedReservation.id),1),p("div",null,[a.selectedReservation.status==0?(u(),k("span",$t,[o(_,{type:"success",onClick:l.reservationCheckin},{default:c(()=>[w(f(e.$t("message.checkin")),1)]),_:1},8,["onClick"])])):v("",!0),a.selectedReservation.status==1?(u(),k("span",Wt,[o(_,{type:"info",onClick:l.reservationCheckout},{default:c(()=>[w(f(e.$t("message.checkout")),1)]),_:1},8,["onClick"])])):v("",!0),p("span",null,[o(_,{onClick:t[1]||(t[1]=P=>s.showFolioDialog=!0),type:"primary"},{default:c(()=>[w("Folio")]),_:1})])]),o(C,null,{default:c(()=>[o(h,{title:"Edit Reservation",name:"2"},{default:c(()=>[s.rootSpaces&&l.rootSpace?(u(),y(S,{key:0,componentKey:s.componentKey,resId:a.selectedReservation.id,checkin:a.selectedReservation.checkin,checkout:a.selectedReservation.checkout,people:a.selectedReservation.people,beds:a.selectedReservation.beds,spaceId:a.selectedReservation.space_id,customer:a.selectedReservation.customer,customerFirst:a.selectedReservation.first_name,customerLast:a.selectedReservation.last_name,"onEditReservation:modifyReservation1":l.modifyReservation1},null,8,["componentKey","resId","checkin","checkout","people","beds","spaceId","customer","customerFirst","customerLast","onEditReservation:modifyReservation1"])):v("",!0)]),_:1}),o(h,{title:"History",name:"1"},{default:c(()=>[p("table",Jt,[p("tbody",null,[(u(!0),k(T,null,I(a.selectedReservation.history,P=>(u(),k("tr",null,[p("td",null,f(P.text),1),p("td",null,f(P.account_name),1),p("td",null,f(P.date),1)]))),256))])])]),_:1})]),_:1})])):v("",!0)],64)}const Zt=D(Ot,[["render",Xt]]);var es={exports:{}};(function(e,t){(function(a,i){e.exports=i(J.exports)})(X,function(a){function i(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var s=i(a),l={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_mi\xE9rcoles_jueves_viernes_s\xE1bado".split("_"),weekdaysShort:"dom._lun._mar._mi\xE9._jue._vie._s\xE1b.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_s\xE1".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un d\xEDa",dd:"%d d\xEDas",M:"un mes",MM:"%d meses",y:"un a\xF1o",yy:"%d a\xF1os"},ordinal:function(n){return n+"\xBA"}};return s.default.locale(l,null,!0),l})})(es);const ts={name:"splitpanes",emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce((e,t)=>(e[t.id]=t)&&e,{})}},methods:{updatePaneComponents(){this.panes.forEach(e=>{e.update&&e.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[e.id].size}%`})})},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(e,t){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=t},onMouseMove(e){this.touch.mouseDown&&(e.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(e)),this.$emit("resize",this.panes.map(t=>({min:t.min,max:t.max,size:t.size}))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map(e=>({min:e.min,max:e.max,size:e.size}))),this.touch.mouseDown=!1,setTimeout(()=>{this.touch.dragging=!1,this.unbindEvents()},100)},onSplitterClick(e,t){"ontouchstart"in window&&(e.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===t?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(e,t),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=t,this.splitterTaps.timeoutId=setTimeout(()=>{this.splitterTaps.splitter=null},500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[t])},onSplitterDblClick(e,t){let a=0;this.panes=this.panes.map((i,s)=>(i.size=s===t?i.max:i.min,s!==t&&(a+=i.min),i)),this.panes[t].size-=a,this.$emit("pane-maximize",this.panes[t]),this.$emit("resized",this.panes.map(i=>({min:i.min,max:i.max,size:i.size})))},onPaneClick(e,t){this.$emit("pane-click",this.indexedPanes[t])},getCurrentMouseDrag(e){const t=this.container.getBoundingClientRect(),{clientX:a,clientY:i}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:a-t.left,y:i-t.top}},getCurrentDragPercentage(e){e=e[this.horizontal?"y":"x"];const t=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(e=t-e),e*100/t},calculatePanesSize(e){const t=this.touch.activeSplitter;let a={prevPanesSize:this.sumPrevPanesSize(t),nextPanesSize:this.sumNextPanesSize(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const i=0+(this.pushOtherPanes?0:a.prevPanesSize),s=100-(this.pushOtherPanes?0:a.nextPanesSize),l=Math.max(Math.min(this.getCurrentDragPercentage(e),s),i);let n=[t,t+1],r=this.panes[n[0]]||null,m=this.panes[n[1]]||null;const _=r.max<100&&l>=r.max+a.prevPanesSize,S=m.max<100&&l<=100-(m.max+this.sumNextPanesSize(t+1));if(_||S){_?(r.size=r.max,m.size=Math.max(100-r.max-a.prevPanesSize-a.nextPanesSize,0)):(r.size=Math.max(100-m.max-a.prevPanesSize-this.sumNextPanesSize(t+1),0),m.size=m.max);return}if(this.pushOtherPanes){const h=this.doPushOtherPanes(a,l);if(!h)return;({sums:a,panesToResize:n}=h),r=this.panes[n[0]]||null,m=this.panes[n[1]]||null}r!==null&&(r.size=Math.min(Math.max(l-a.prevPanesSize-a.prevReachedMinPanes,r.min),r.max)),m!==null&&(m.size=Math.min(Math.max(100-l-a.nextPanesSize-a.nextReachedMinPanes,m.min),m.max))},doPushOtherPanes(e,t){const a=this.touch.activeSplitter,i=[a,a+1];return t<e.prevPanesSize+this.panes[i[0]].min&&(i[0]=this.findPrevExpandedPane(a).index,e.prevReachedMinPanes=0,i[0]<a&&this.panes.forEach((s,l)=>{l>i[0]&&l<=a&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),e.prevPanesSize=this.sumPrevPanesSize(i[0]),i[0]===void 0)?(e.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach((s,l)=>{l>0&&l<=a&&(s.size=s.min,e.prevReachedMinPanes+=s.min)}),this.panes[i[1]].size=100-e.prevReachedMinPanes-this.panes[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-this.panes[i[1]].min&&(i[1]=this.findNextExpandedPane(a).index,e.nextReachedMinPanes=0,i[1]>a+1&&this.panes.forEach((s,l)=>{l>a&&l<i[1]&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),e.nextPanesSize=this.sumNextPanesSize(i[1]-1),i[1]===void 0)?(e.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach((s,l)=>{l<this.panesCount-1&&l>=a+1&&(s.size=s.min,e.nextReachedMinPanes+=s.min)}),this.panes[i[0]].size=100-e.prevPanesSize-e.nextReachedMinPanes-this.panes[this.panesCount-1].min-e.nextPanesSize,null):{sums:e,panesToResize:i}},sumPrevPanesSize(e){return this.panes.reduce((t,a,i)=>t+(i<e?a.size:0),0)},sumNextPanesSize(e){return this.panes.reduce((t,a,i)=>t+(i>e+1?a.size:0),0)},findPrevExpandedPane(e){return[...this.panes].reverse().find(t=>t.index<e&&t.size>t.min)||{}},findNextExpandedPane(e){return this.panes.find(t=>t.index>e+1&&t.size>t.min)||{}},checkSplitpanesNodes(){Array.from(this.container.children).forEach(e=>{const t=e.classList.contains("splitpanes__pane"),a=e.classList.contains("splitpanes__splitter");!t&&!a&&(e.parentNode.removeChild(e),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},addSplitter(e,t,a=!1){const i=e-1,s=document.createElement("div");s.classList.add("splitpanes__splitter"),a||(s.onmousedown=l=>this.onMouseDown(l,i),typeof window<"u"&&"ontouchstart"in window&&(s.ontouchstart=l=>this.onMouseDown(l,i)),s.onclick=l=>this.onSplitterClick(l,i+1)),this.dblClickSplitter&&(s.ondblclick=l=>this.onSplitterDblClick(l,i+1)),t.parentNode.insertBefore(s,t)},removeSplitter(e){e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.parentNode.removeChild(e)},redoSplitters(){const e=Array.from(this.container.children);e.forEach(a=>{a.className.includes("splitpanes__splitter")&&this.removeSplitter(a)});let t=0;e.forEach(a=>{a.className.includes("splitpanes__pane")&&(!t&&this.firstSplitter?this.addSplitter(t,a,!0):t&&this.addSplitter(t,a),t++)})},requestUpdate({target:e,...t}){const a=this.indexedPanes[e._.uid];Object.entries(t).forEach(([i,s])=>a[i]=s)},onPaneAdd(e){let t=-1;Array.from(e.$el.parentNode.children).some(s=>(s.className.includes("splitpanes__pane")&&t++,s===e.$el));const a=parseFloat(e.minSize),i=parseFloat(e.maxSize);this.panes.splice(t,0,{id:e._.uid,index:t,min:isNaN(a)?0:a,max:isNaN(i)?100:i,size:e.size===null?null:parseFloat(e.size),givenSize:e.size,update:e.update}),this.panes.forEach((s,l)=>s.index=l),this.ready&&this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[t]}),this.$emit("pane-add",{index:t,panes:this.panes.map(s=>({min:s.min,max:s.max,size:s.size}))})})},onPaneRemove(e){const t=this.panes.findIndex(i=>i.id===e._.uid),a=this.panes.splice(t,1)[0];this.panes.forEach((i,s)=>i.index=s),this.$nextTick(()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:{...a,index:t}}),this.$emit("pane-remove",{removed:a,panes:this.panes.map(i=>({min:i.min,max:i.max,size:i.size}))})})},resetPaneSizes(e={}){!e.addedPane&&!e.removedPane?this.initialPanesSizing():this.panes.some(t=>t.givenSize!==null||t.min||t.max<100)?this.equalizeAfterAddOrRemove(e):this.equalize(),this.ready&&this.$emit("resized",this.panes.map(t=>({min:t.min,max:t.max,size:t.size})))},equalize(){const e=100/this.panesCount;let t=0;const a=[],i=[];this.panes.forEach(s=>{s.size=Math.max(Math.min(e,s.max),s.min),t-=s.size,s.size>=s.max&&a.push(s.id),s.size<=s.min&&i.push(s.id)}),t>.1&&this.readjustSizes(t,a,i)},initialPanesSizing(){let e=100;const t=[],a=[];let i=0;this.panes.forEach(l=>{e-=l.size,l.size!==null&&i++,l.size>=l.max&&t.push(l.id),l.size<=l.min&&a.push(l.id)});let s=100;e>.1&&(this.panes.forEach(l=>{l.size===null&&(l.size=Math.max(Math.min(e/(this.panesCount-i),l.max),l.min)),s-=l.size}),s>.1&&this.readjustSizes(e,t,a))},equalizeAfterAddOrRemove({addedPane:e,removedPane:t}={}){let a=100/this.panesCount,i=0;const s=[],l=[];e&&e.givenSize!==null&&(a=(100-e.givenSize)/(this.panesCount-1)),this.panes.forEach(n=>{i-=n.size,n.size>=n.max&&s.push(n.id),n.size<=n.min&&l.push(n.id)}),!(Math.abs(i)<.1)&&(this.panes.forEach(n=>{e&&e.givenSize!==null&&e.id===n.id||(n.size=Math.max(Math.min(a,n.max),n.min)),i-=n.size,n.size>=n.max&&s.push(n.id),n.size<=n.min&&l.push(n.id)}),i>.1&&this.readjustSizes(i,s,l))},readjustSizes(e,t,a){let i;e>0?i=e/(this.panesCount-t.length):i=e/(this.panesCount-a.length),this.panes.forEach((s,l)=>{if(e>0&&!t.includes(s.id)){const n=Math.max(Math.min(s.size+i,s.max),s.min),r=n-s.size;e-=r,s.size=n}else if(!a.includes(s.id)){const n=Math.max(Math.min(s.size+i,s.max),s.min),r=n-s.size;e-=r,s.size=n}s.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[s.id].size}%`})}),Math.abs(e)>.1&&this.$nextTick(()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(e){[...this.container.querySelectorAll(".splitpanes__splitter")].forEach((t,a)=>{t.ondblclick=e?i=>this.onSplitterDblClick(i,a):void 0})}},beforeUnmount(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(){return Z("div",{ref:"container",class:["splitpanes",`splitpanes--${this.horizontal?"horizontal":"vertical"}`,{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default())}},ss=(e,t)=>{const a=e.__vccOpts||e;for(const[i,s]of t)a[i]=s;return a},ls={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeUnmount(){this.onPaneRemove(this)},methods:{update(e){this.style=e}},computed:{sizeNumber(){return this.size||this.size===0?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(e){this.requestUpdate({target:this,size:e})},minSizeNumber(e){this.requestUpdate({target:this,min:e})},maxSizeNumber(e){this.requestUpdate({target:this,max:e})}}};function as(e,t,a,i,s,l){return u(),k("div",{class:"splitpanes__pane",onClick:t[0]||(t[0]=n=>l.onPaneClick(n,e._.uid)),style:te(e.style)},[ee(e.$slots,"default")],4)}const os=ss(ls,[["render",as]]);const ns={setup(){const{handleRequestError:e}=L();return{handleRequestError:e}},name:"resView3",components:{singleDatePicker:ae,ResViewTable:Ne,CreateReservation:ot,ReservationView:Zt,Splitpanes:ts,Pane:os},data(){return{leftPaneSize:30,overRideSingleDatePicker:"",reservationDialog:!1,reservations:[],rootSpaces:null,selectedReservation:null,showCreateReservation:!0,showReservationView:!1,trigger:1,windowHeight:0,windowWidth:0,componentTrigger:0}},computed:{locale(){return F().selectedLocale},token(){return Y().token},rDrawerWidth(){if(this.windowWidth<768)return"100%";if(this.windowWidth>768&&this.windowWidth<1200)return"500px";if(this.windowWidth>=1200)return"35%"},resViewEndDate(){return g(this.resViewStartDate).add(31,"days").format("YYYY-MM-DD")},resViewStartDate(){return z().startDate},resTableData(){let e,t,a,i,s,l,n;return b.each(this.rootSpaces,r=>{const m=Object.keys(r);b.each(m,_=>{_.substring(0,1)=="D"&&delete r[_]})}),n=this.rootSpaces,b.each(this.reservations,r=>{if(r.checkout!=this.resViewStartDate){let m=b.find(n,_=>_.id==r.space_id);if(m){g(r.checkout).isAfter(g(this.resViewEndDate))?i=!1:i=!0,g(r.checkin).isBefore(g(this.resViewStartDate))?(a=!1,e=g(this.resViewStartDate).format("YYYYMMDD"),t=g(this.resViewStartDate).format("YYYY-MM-DD"),g(r.checkout).diff(g(this.resViewStartDate),"d")):(a=!0,e=g(r.checkin).format("YYYYMMDD"),t=g(r.checkin).format("YYYY-MM-DD"),g(r.checkout).diff(g(r.checkin),"d"));let _=g(r.checkout).diff(g(t),"d");for(let S=0;S<_;S++){let h=g(e).add(S,"d").format("YYYYMMDD");S==0&&(s="D"+h+"isfirst",m[s]=!0),g(this.resViewEndDate).isSame(h)&&(s="D"+h+"islast",m[s]=!0),s="D"+h+"blocked",m[s]=!1,s="D"+h+"starttruncated",m[s]=!a,s="D"+h+"endtruncated",m[s]=!i,s="D"+h+"resid",m[s]=r.id,s="D"+h+"start",m[s]=r.checkin,s="D"+h+"end",m[s]=r.checkout,s="D"+h+"customer",m[s]=r.customer_last,s="D"+h+"status",m[s]=r.status}}m.children.length>0&&b.forEach(m.children,_=>{let S=b.find(n,h=>h.id==_);if(S){let h=g(r.checkout).diff(g(t),"d");for(let C=0;C<h;C++){let P=g(e).add(C,"d").format("YYYYMMDD");if(l="D"+P+"blocked",!S[l]){let V="D"+P+"blocked";S[V]=!0,V="D"+P+"span",S[V]=1,V="D"+P+"resIdRef",S[V]=r.id}}}}),m.parents.length>0&&b.forEach(m.parents,_=>{let S=b.find(n,h=>h.id==_);if(S){let h=g(r.checkout).diff(g(t),"d");for(let C=0;C<h;C++){let P=g(e).add(C,"d").format("YYYYMMDD"),V="D"+P+"blocked";if(!S[V]){let R="D"+P+"blocked";S[R]=!0,R="D"+P+"span",S[R]=1,R="D"+P+"resIdRef",S[R]=r.id}}}})}}),n},tableHeight(){return this.windowHeight-110},tDateArray(){g.locale(this.locale.name);const e=[];for(let t=0;t<32;t++){let a={dayString:"D"+g(this.resViewStartDate).add(t,"day").format("YYYYMMDD"),dayLabel:g(this.resViewStartDate).add(t,"day").format("ddd MMM D")};e.push(a)}return e}},methods:{clearReservations(){},closeReservationView(){this.showCreateReservation=!0,this.showReservationView=!1},emptyCellClick(e){console.log("empty cell selected",e)},getReservations(){x.reservations.getReservationsByRange(this.resViewStartDate,this.resViewEndDate,this.token).then(e=>{console.log("res fetch from rv3 getR()"),this.reservations=e.data.reservations,this.componentTrigger+=1}).catch(e=>{this.handleRequestError(e),this.reservations=[]})},leftPane100(){this.leftPaneSize=100},leftPane30(){this.leftPaneSize=30},leftPane50(){this.leftPaneSize=50},leftPane70(){this.leftPaneSize=70},leftPane10(){this.leftPaneSize=5},leftResize(e){console.log(e)},reservationSelected(e){this.selectedReservation=b.find(this.reservations,function(t){return t.id==e}),this.showCreateReservation=!1,this.showReservationView=!0},rowClassName(e){},showCreateReservationFtn(){this.showCreateReservation=!0,this.showReservationView=!1},singleDateSelected(e){let t=g(e).format("YYYY-MM-DD");z().startDate=t,this.getReservations()},toggleShowChildren(e){let t=b.find(this.rootSpaces,s=>s.id==e),a=s=>{s.showChildren=!1,s.children&&b.each(s.children,l=>{let n=b.find(this.spaceRecords,r=>r.id==l);n&&a(n)})};(s=>{s.showChildren==!0?(s.showChildren=!1,s.children&&b.each(s.children,l=>{let n=b.find(this.spaceRecords,r=>r.id==l);n&&a(n)})):s.showChildren=!0})(t),z().setShowHideRootSpaceCopy(this.rootSpaces)},toggleCreateReservationDrawer(){this.showCreateReservationDrawer=!this.showCreateReservationDrawer},updateSelectedReservation(e){this.selectedReservation=e},viewBack1(){const e=g(z().startDate).subtract(1,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewBack7(){const e=g(z().startDate).subtract(7,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewForward1(){const e=g(z().startDate).add(1,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e},viewForward7(){const e=g(z().startDate).add(7,"days").format("YYYY-MM-DD");this.overRideSingleDatePicker=e}},created(){g.extend(g),g.extend(g),this.spaceRecords={}},mounted(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,window.addEventListener("resize",e=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight},!0),z().showHideRootSpaceCopy?this.rootSpaces=z().showHideRootSpaceCopy:this.rootSpaces=E().rootSpaces,this.getReservations()}},rs={style:{display:"flex","flex-direction":"row-reverse"}},is={style:{"margin-left":"4px"}};function cs(e,t,a,i,s,l){const n=d("el-button"),r=d("el-button-group"),m=d("CreateReservation"),_=d("ReservationView"),S=d("pane"),h=d("singleDatePicker"),C=d("ResViewTable"),P=d("splitpanes");return u(),y(P,{onResized:l.leftResize},{default:c(()=>[o(S,{size:s.leftPaneSize},{default:c(()=>[p("div",rs,[o(r,null,{default:c(()=>[o(n,{type:"warning",onClick:l.leftPane10},{default:c(()=>[w("<<")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane30},{default:c(()=>[w("<")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane50},{default:c(()=>[w("|")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane70},{default:c(()=>[w(">")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.leftPane100},{default:c(()=>[w(">>")]),_:1},8,["onClick"])]),_:1})]),s.showCreateReservation?(u(),y(m,{key:0,"onCreateReservation:reloadReservations":l.getReservations},null,8,["onCreateReservation:reloadReservations"])):v("",!0),s.showReservationView?(u(),y(_,{key:1,selectedReservation:s.selectedReservation,"onReservationView:closeView":l.closeReservationView,"onReservationView:updateReservations":l.getReservations,"onReservationView:updateSelectedReservation":l.updateSelectedReservation},null,8,["selectedReservation","onReservationView:closeView","onReservationView:updateReservations","onReservationView:updateSelectedReservation"])):v("",!0)]),_:1},8,["size"]),o(S,{size:100-s.leftPaneSize},{default:c(()=>[p("div",is,[p("span",null,[o(r,null,{default:c(()=>[o(n,{type:"warning",onClick:l.viewBack7},{default:c(()=>[w("-7")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.viewBack1},{default:c(()=>[w("-1")]),_:1},8,["onClick"])]),_:1}),o(h,{overrideDate:s.overRideSingleDatePicker,"onSingleDatePicker:dateSelected":l.singleDateSelected},null,8,["overrideDate","onSingleDatePicker:dateSelected"]),o(r,null,{default:c(()=>[o(n,{type:"warning",onClick:l.viewForward1},{default:c(()=>[w("+1")]),_:1},8,["onClick"]),o(n,{type:"warning",onClick:l.viewForward7},{default:c(()=>[w("+7")]),_:1},8,["onClick"])]),_:1}),w("\xA0 "),o(n,{type:"success",onClick:l.showCreateReservationFtn},{default:c(()=>[w(f(e.$t("message.createReservation")),1)]),_:1},8,["onClick"])]),s.rootSpaces?(u(),y(C,{key:0,onResBlockClick:l.reservationSelected,onResviewToggleShowChildren:l.toggleShowChildren,onEmptyCellClick:l.emptyCellClick,tDateArray:l.tDateArray,tableData:l.resTableData,trigger:s.trigger,resSpaceCopy:e.spaceRecords,tableHeight:l.tableHeight},null,8,["onResBlockClick","onResviewToggleShowChildren","onEmptyCellClick","tDateArray","tableData","trigger","resSpaceCopy","tableHeight"])):v("",!0)])]),_:1},8,["size"])]),_:1},8,["onResized"])}const us=D(ns,[["render",cs]]);export{us as default};
